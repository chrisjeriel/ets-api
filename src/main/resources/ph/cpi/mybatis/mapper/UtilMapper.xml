<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ph.cpi.mybatis.mapper.UtilMapper">
	
	<update id="extractPOLR044A" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044A_PKG.EXTRACT_POL_WRITTENCOMP(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044B" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044B_PKG.extract_pol_expirylist (
											        #{extractUser, jdbcType=VARCHAR}, 
                                                    #{extractDate, jdbcType=VARCHAR}, 
                                                    #{lineCdParam, jdbcType=VARCHAR}, 
                                                    #{cedingIdParam, jdbcType=VARCHAR}, 
                                                    #{dateRange, jdbcType=VARCHAR}, 
                                                    CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  	CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											        #{extractCount, mode=OUT, jdbcType=INTEGER},
											        #{forceExtract, jdbcType=VARCHAR}
										        );
		END;
	</update>
	
	<update id="extractPOLR044D" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044D_PKG.extract_pol_monytdissue(
											        #{extractUser, jdbcType=VARCHAR},
											        #{dateParam, jdbcType=VARCHAR},
											        #{dateRange, jdbcType=VARCHAR},
											        CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											        #{extractCount, jdbcType=INTEGER, mode=OUT},
											        #{forceExtract, jdbcType=VARCHAR}
											    );
		END;
	</update>
	
	<update id="extractPOLR044E" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044E_PKG.extract_pol_buswritten_ext (
												        #{extractUser, jdbcType=VARCHAR}, 
												        #{dateParam, jdbcType=VARCHAR}, 
												        #{dateRange, jdbcType=VARCHAR},
												        CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												        CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												        #{incRecTag, jdbcType=VARCHAR},
												        #{extractCount, jdbcType=INTEGER, mode=OUT},
												        #{forceExtract, jdbcType=VARCHAR}
												    );
		END;
	</update>
	
	<update id="extractPOLR044G" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044G_PKG.extract_pol_renwritten_ext(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044H" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044H_PKG.extract_pol_premw(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044I" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044I_PKG.extract_pol_ribinderstat(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044J" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044J_PKG.extract_pol_prembrdx(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044K" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044K_PKG.extract_get_pol_otwrdfcl(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044L" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044L_PKG.extract_pol_osdistlist(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044M" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044M_PKG.extract_pol_wetriskzone(#{extractUser, jdbcType=VARCHAR},
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044N" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044N_PKG.extract_pol_curexposure(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>

	<update id="extractPOLR044O" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044O_PKG.extract_burncost(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044P" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044P_PKG.extract_accsipercomp(#{extractUser, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044Q" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044Q_PKG.extract_accsiall(#{extractUser, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractACITR061F" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			ACITR061F_PKG.extract_acitr061f(#{extractUser, jdbcType=VARCHAR},
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractACITR061G" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			ACITR061G_PKG.extract_acitr061g(#{extractUser, jdbcType=VARCHAR},
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044V" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044V_PKG.extract_polr044v(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044W" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044W_PKG.extract_polr044w(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractPOLR044X" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POLR044X_PKG.extract_polr044x(#{extractUser, jdbcType=VARCHAR},
												  #{lineCdParam, jdbcType=VARCHAR},
												  #{cedingIdParam, jdbcType=VARCHAR}, 
												  #{dateParam, jdbcType=VARCHAR},
												  #{dateRange, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{incRecTag, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractACITR048A" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			ACITR048A_PKG.extract_acitr048a(#{extractUser, jdbcType=VARCHAR},
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractCLMR010A" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			CLMR010A_PKG.extract_clm_largeloss(#{extractUser, jdbcType=VARCHAR},
												#{lineCdParam, jdbcType=VARCHAR},
												#{cedingIdParam, jdbcType=VARCHAR},
												#{dateParam, jdbcType=VARCHAR},
												#{dateRange, jdbcType=VARCHAR},
												CAST(to_timestamp(#{fromDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  CAST(to_timestamp(#{toDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{extractCount, mode=OUT, jdbcType=INTEGER},
												  #{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="extractBRDRX" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			ACIT_BRDRX_EXT_PKG.extract_acit_brdrx(#{extractUser, jdbcType=VARCHAR},
												#{osPaidTag, jdbcType=VARCHAR},
												#{extTypeTag, jdbcType=VARCHAR},
												#{dateParam, jdbcType=VARCHAR},
												#{dateRange, jdbcType=VARCHAR},
												CAST(to_timestamp(#{dateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											    CAST(to_timestamp(#{dateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												#{lineCd, jdbcType=VARCHAR},
												#{cessionId, jdbcType=VARCHAR},
												#{extractCount, mode=OUT, jdbcType=INTEGER},
												#{forceExtract, jdbcType=VARCHAR});
		END;
	</update>
	
	
	
	<select id="getReportFileName" resultType="java.lang.String" parameterType="java.util.Map" >
		SELECT MTN_REPORTS_PKG.get_report_file_name(#{reportId}) FROM DUAL
	</select>
	
	<select id="getReportPath" resultType="java.lang.String"  >
		SELECT MTN_REPORTS_PKG.get_report_path() FROM DUAL
	</select>
</mapper>