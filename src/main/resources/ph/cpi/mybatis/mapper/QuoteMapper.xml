<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ph.cpi.mybatis.mapper.QuoteMapper">
	
	<resultMap type="java.util.Map" id="sampleMap">
		<result property="insuredName" column="insured_name"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.Alop" id="alopMap">
	    <result property="alopId" 			column="ALOP_ID"/> 
		<result property="insuredId" 		column="INS_ID"/> 
		<result property="insuredName" 		column="INSURED_NAME"/> 
		<result property="insuredDesc" 		column="INSURED_DESC"/> 
		<result property="address" 			column="ADDRESS"/> 
		<result property="insuredBusiness" 	column="INS_BUSINESS"/> 
		<result property="annSi" 			column="ANN_SI"/> 
		<result property="maxIndemPdSi" 	column="MAX_INDEM_PD_SI"/> 
		<result property="issueDate" 		column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/> 
		<result property="expiryDate" 		column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/> 
		<result property="maxIndemPd" 		column="MAX_INDEM_PD"/> 
		<result property="indemFromDate" 	column="INDEM_FROM_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/> 
		<result property="timeExc" 			column="TIME_EXC"/> 
		<result property="repInterval" 		column="REP_INTERVAL"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
	</resultMap>
	
	
	<select id="retrieveQuoteAlopSample" resultMap="alopMap" parameterType="java.util.Map">
			SELECT * FROM CPI.ETS_QUOTE_PKG.retrieve_quote_alop(#{quoteId},#{quotationNo})
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.quote.SectionCovers" id="sectionCovers">
		<result property="section" column="SECTION" />
		<result property="coverCd" column="COVER_CD" />
		<result property="bulletNo" column="BULLET_NO" />
		<result property="sumInsured" column="SUM_INSURED" />
		<result property="addSi" column="ADD_SI" />
		<result property="createUser" column="SECTION_CREATE_USER" />
		<result property="createDate" column="SECTION_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="SECTION_UPDATE_USER" />
		<result property="updateDate" column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.Coverage" id="coverage">
		<result property="sectionISi" column="SECTION_I_SI"/>
		<result property="sectionIISi" column="SECTION_II_SI"/>
		<result property="sectionIIISi" column="SECTION_III_SI"/>
		<result property="totalSi" column="TOTAL_SI"/>
		<result property="currencyCd" column="CURRENCY_CD"/>
		<result property="currencyRt" column="CURRENCY_RT"/>
		<result property="remarks" column="REMARKS"/>
		<result property="createUser" column="CREATE_USER"/>
		<result property="createDate" column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="UPDATE_USER"/>
		<association property="sectionCovers" resultMap="sectionCovers"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.Project" id="project">
		<result property="riskId" column="RISK_ID"/>
		<result property="riskName" column="RISK_NAME"/>
		<association property="coverage" resultMap="coverage"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.Quotation" id="quotation">
		<result property="quoteId" column="QUOTE_ID"/>
		<result property="quoteName" column="QUOTE_NAME"/>
		<association property="project" resultMap="project"></association>
	</resultMap>
	
	<select id="retrieveQuoteCoverage" resultMap="quotation" parameterType="java.util.Map">
		SELECT * FROM CPI.ETS_QUOTE_PKG_PCPCR.retrieve_quote_coverage(#{quoteId, jdbcType=VARCHAR},#{quotationNo, jdbcType=VARCHAR},'',1,'','')
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.quote.Attachment" id="attachmentOc">
		<result property="fileNo" column="FILE_NO" />
		<result property="fileName" column="FILE_NAME" />
		<result property="description" column="DESCRIPTION" />
		<result property="createUser" column="ATT_CREATE_USER" />
		<result property="createDate" column="ATT_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="ATT_UPDATE_USER" />
		<result property="updateDate" column="ATT_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.EndorsementsOc" id="endorsementsOc">
		<result property="endtCd" column="ENDT_CD"/>
		<result property="endtTitle" column="ENDT_TITLE"/>
		<result property="remarks" column="REMARKS"/>
		<result property="createUser" column="ENDT_CREATE_USER"/>
		<result property="createDate" column="ENDT_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="ENDT_UPDATE_USER"/>
		<result property="updateDate" column="ENDT_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.CoverageOc" id="coverageOc">
		<result property="riskId" column="COV_RISK_ID"/>
		<result property="maxSi" column="COV_MAX_SI"/>
		<result property="currencyCd" column="COVERRAGE_CURRENCY_CD"/>
		<result property="currencyRt" column="COVERAGE_CURRENCY_RT"/>
		<result property="pctShare" column="COV_PCT_SHARE"/>
		<result property="pctPml" column="PCT_PML"/>
		<result property="totalValue" column="COV_TOTAL_VALUE"/>
		<result property="createUser" column="COV_CREATE_USER"/>
		<result property="createDate" column="COV_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="COV_UPDATE_USER"/>
		<result property="updateDate" column="COV_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.ProjectOc" id="projectOc">
		<result property="projId" column="PROJ_ID"/>
		<result property="projDesc" column="PROJ_DESC"/>
		<result property="riskId" column="PROJ_RISK_ID"/>
		<result property="maxSi" column="PROJ_MAX_SI"/>
		<result property="pctShare" column="PROJ_PCT_SHARE"/>
		<result property="totalValue" column="PROJ_TOTAL_VALUE"/>
		<result property="objectId" column="OBJECT_ID"/>
		<result property="site" column="SITE"/>
		<result property="duration" column="DURATION"/>
		<result property="testing" column="TESTING"/>
		<result property="createUser" column="PRJ_CREATE_USER"/>
		<result property="createDate" column="PRJ_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="PRJ_UPDATE_USER"/>
		<result property="updateDate" column="PRJ_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<association property="coverageOc" resultMap="coverageOc"></association>
		<association property="endorsementsOc" resultMap="endorsementsOc"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.quote.QuotationOc" id="quotationOc">
		<result property="quoteIdOc" column="QUOTE_ID_OC"/>
		<result property="openQuotationNo" column="QUOTE_NO"/>
		<result property="lineCd" column="LINE_CD"/>
		<result property="lineCdDesc" column="LINE_CD_DESCRIPTION"/>
		<result property="year" column="YEAR"/>
		<result property="seqNo" column="SEQ_NO"/>
		<result property="sevNo" column="REV_NO"/>
		<result property="cedingId" column="CEDING_ID"/>
		<result property="cessionId" column="CESSION_ID"/>
		<result property="cedingName" column="CEDING_NAME"/>
		<result property="lineClassCd" column="LINE_CLASS_CD"/>
		<result property="lineClassDesc" column="LINE_CLASS_DESCRIPTION"/>
		<result property="refPolNo" column="REF_POL_NO"/>
		<result property="policyIdOc" column="POLICY_ID_OC"/>
		<result property="openPolicyNo" column="POLICY_NO"/>
		<result property="prinId" column="PRIN_ID"/>
		<result property="principalName" column="PRINCIPAL_NAME"/>
		<result property="contractorId" column="CONTRACTOR_ID"/>
		<result property="contactorName" column="CONTRACTOR_NAME"/>
		<result property="insuredDesc" column="INSURED_DESC"/>
		<result property="status" column="STATUS"/>
		<result property="reinsurerId" column="REINSURER_ID"/>
		<result property="reinsurerName" column="REINSURER_NAME"/>
		<result property="intmId" column="INTM_ID"/>
		<result property="intmName" column="INTM_NAME"/>
		<result property="issueDate" column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="expiryDate" column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="reqBy" column="REQ_BY"/>
		<result property="reqDate" column="REQ_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="reqMode" column="REQ_MODE"/>
		<result property="currencyCd" column="QUOTE_CURRENCY_CD"/>
		<result property="currencyRt" column="QUOTE_CURRENCY_RT"/>
		<result property="govtTag" column="GOVT_TAG"/>
		<result property="indicativeTag" column="INDICATIVE_TAG"/>
		<result property="preparedBy" column="PREPARED_BY"/>
		<result property="approvedBy" column="APPROVED_BY"/>
		<result property="printedBy" column="PRINTED_BY"/>
		<result property="printDate" column="PRINT_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="openingParag" column="OPENING_PARAG"/>
		<result property="closingParag" column="CLOSING_PARAG"/>
		<result property="reasonCd" column="REASON_CD"/>
		<result property="reasonDesc" column="REASON_DESCRIPTION"/>
		<result property="createUser" column="QUO_CREATE_USER"/>
		<result property="createDate" column="QUO_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<result property="updateUser" column="QUO_UPDATE_USER"/>
		<result property="updateDate" column="QUO_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.LocalDateTypeHandler"/>
		<association property="attachment" resultMap="attachmentOc"></association>
	</resultMap>
	
	<select id="retrieveQuoteDetailsOc" resultMap="quotationOc" parameterType="java.util.Map">
		SELECT * FROM CPI.ETS_QUOTE_PKG_PCPCR.retrieve_quote_details_oc(#{openQuotationNo, jdbcType=VARCHAR},#{quoteIdOc, jdbcType=VARCHAR},'',1,'','')
	</select>
	
</mapper>