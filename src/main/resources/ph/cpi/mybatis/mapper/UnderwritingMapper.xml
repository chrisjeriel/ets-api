<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ph.cpi.mybatis.mapper.UnderwritingMapper">
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="retInwPolBalMap">
		<result property="policyId" 			column="POLICY_ID"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<result property="inceptDate" 			column="INCEPT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="issueDate" 			column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="inwPolBalance" 	resultMap="inwPolBalMap"/>
		<association property="project" 	resultMap="inwPolBalProjMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Project" id="inwPolBalProjMap">
		<association property="coverage" 	resultMap="inwPolBalCovMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Coverage" id="inwPolBalCovMap">
		<result property="totalPrem" 			column="TOTAL_PREM"/>
		<result property="currencyCd" 			column="CURRENCY_CD"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.InwPolBalance" id="inwPolBalMap">
		<result property="instNo" 				column="INST_NO"/>
		<result property="dueDate" 				column="DUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="bookingDate" 			column="BOOKING_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="premAmt" 				column="PREM_AMT"/>
		<result property="commRt"               column="COMM_RT"/>
		<result property="commAmt"              column="COMM_AMT"/>
		<result property="otherChargesInw" 		column="OTHER_CHARGES"/>
		<result property="amtDue" 				column="AMT_DUE"/>
		<result property="createUser" 			column="CREATE_USER"/>
		<result property="createDate" 			column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser"	 		column="UPDATE_USER"/>
		<result property="updateDate" 			column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="otherCharges" 	resultMap = "otherChargesMap"/> 
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.OtherCharges" id="otherChargesMap">
		<result property="instNo"			column="OTHER_INST_NO"/> 
		<result property="chargeCd"			column="CHARGE_CD"/>
		<result property="amount"			column="AMOUNT"/>
		<result property="chargeDesc"		column="CHARGE_DESC"/>
		<result property="createUser"		column="OTHER_CREATE_USER"/>
		<result property="createDate"		column="OTHER_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser"		column="OTHER_UPDATE_USER"/>
		<result property="updateDate"		column="OTHER_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap> 
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="policyMap">
		<result property="policyId" 			column="POLICY_ID"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<result property="lineCd" 				column="LINE_CD"/>
		<result property="lineCdDesc" 			column="LINE_DESC"/>
		<result property="polYear" 				column="POL_YEAR"/>
		<result property="polSeqNo" 			column="POL_SEQ_NO"/>
		<result property="cedingId" 			column="CEDING_ID"/>
		<result property="cedingName" 			column="CEDING_NAME"/>
		<result property="coSeriesNo" 			column="CO_SERIES_NO"/>
		<result property="altNo" 				column="ALT_NO"/>
		<result property="cessionId" 			column="CESSION_ID"/>
		<result property="cessionDesc" 			column="CESSION_DESC"/>
		<result property="lineClassCd" 			column="LINE_CLASS_CD"/>
		<result property="lineClassDesc" 		column="LINE_CLASS_DESC"/>
		<result property="insuredDesc" 			column="INSURED_DESC"/>
		<result property="quoteId" 				column="QUOTE_ID"/>
		<result property="optionId" 			column="OPTION_ID"/>
		<result property="quotationNo" 			column="QUOTATION_NO"/>
		<result property="holdCoverNo" 			column="HOLD_COV_NO"/>
		<result property="status" 				column="STATUS"/>
		<result property="statusDesc" 			column="STATUS_DESC"/>
		<result property="coRefNo" 				column="CO_REF_NO"/>
		<result property="reinsurerId" 			column="REINSURER_ID"/>
		<result property="reinsurerName" 		column="REINSURER_NAME"/>
		<result property="riBinderNo" 			column="RI_BINDER_NO"/>
		<result property="mbiRefNo" 			column="MBI_REF_NO"/>
		<result property="policyIdOc" 			column="POLICY_ID_OC"/>
		<result property="openPolicyNo"			column="OC_POLICY_NO"/>
		<result property="refOpenPolNo" 		column="REF_OPEN_POL_NO"/>
		<result property="intmId" 				column="INTM_ID"/>
		<result property="intmName" 			column="INTM_NAME"/>
		<result property="principalId" 			column="PRIN_ID"/>
		<result property="principalName" 		column="PRINCIPAL_NAME"/>
		<result property="contractorId" 		column="CONTRACTOR_ID"/>
		<result property="contractorName" 		column="CONTRACTOR_NAME"/>
		<result property="inceptDate" 			column="INCEPT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="expiryDate" 			column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="lapseFrom" 			column="LAPSE_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="lapseTo" 				column="LAPSE_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="maintenanceFrom" 		column="MAINTENANCE_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="maintenanceTo" 		column="MAINTENANCE_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="issueDate" 			column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="effDate" 				column="EFF_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="distDate" 			column="DIST_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="acctDate" 			column="ACCT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="currencyCd" 			column="CURRENCY_CD"/>
		<result property="currencyRt" 			column="CURRENCY_RT"/>
		<result property="bookedTag" 			column="BOOKED_TAG"/>
		<result property="govtTag" 				column="GOVT_TAG"/>
		<result property="openCoverTag" 		column="OPEN_COVER_TAG"/>
		<result property="holdCoverTag" 		column="HOLD_COVER_TAG"/>
		<result property="declarationTag" 		column="DECLARATION_TAG"/>
		<result property="minDepTag" 			column="MIN_DEP_TAG"/>
		<result property="altTag" 				column="ALT_TAG"/>
		<result property="specialPolicyTag" 	column="SPECIAL_POLICY_TAG"/>
		<result property="instTag" 				column="INST_TAG"/>
		<result property="extensionTag" 		column="EXTENSION_TAG"/>
		<result property="excludeDistTag" 		column="EXCLUDE_DIST_TAG"/>
		<result property="coinsGrpId" 			column="COINS_GRP_ID"/>
		<result property="wordings" 			column="WORDINGS"/>
		<result property="createUser" 			column="CREATE_USER"/>
		<result property="createDate" 			column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" 			column="UPDATE_USER"/>
		<result property="updateDate" 			column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>

		<association property="inwPolBalance" 	resultMap="inwPolBalMap"/>
		<association property="coInsurance" 	resultMap="coInsuranceMap"/>
		<association property="deductibles" 	resultMap="PolDeductiblesMap"/>
		<association property="project" 		resultMap="projectMap"/>
		<association property="alop" 			resultMap="assocAlop"/>
		<association property="holdCoverList"	resultMap="holdCoverMap"/>
		<association property="alterationHist" 	resultMap="AlterationHistMap"/>
		<association property="polWordings" resultMap="PolWordingsMap"></association>
		<association property="endtText" resultMap="assocEndorsementsMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.AlterationHist" id="AlterationHistMap" >
		<result property="policyId"     column="ALT_POLICY_ID"/>
		<result property="policyNo"     column="ALT_POLICY_NO"/>
		<result property="effDate"  column="ALT_EFF_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="issueDate"    column="ALT_ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="quotationNo"  column="ALT_QUOTATION_NO"/>
		<result property="sumInsured"   column="ALT_TOTAL_SI"/>
		<result property="premAmt"  column="ALT_TOTAL_PREM"/>
		<result property="status"   column="ALT_STATUS_DESC"/>
		<result property="insured"   column="ALT_INSURED"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="policyListingMap">
		<result property="policyId" 			column="POLICY_ID"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<result property="cessionDesc" 			column="CESSION_DESC"/>
		<result property="cedingId" 			column="CEDING_ID"/>	
		<result property="cedingName" 			column="CEDING_NAME"/>		
		<result property="lineClassDesc" 		column="LINE_CLASS_DESC"/>
		<result property="insuredDesc" 			column="INSURED_DESC"/>
		<result property="currencyCd" 			column="CURRENCY_CD"/>
		<result property="issueDate" 			column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="expiryDate" 			column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="inceptDate" 			column="INCEPT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="acctDate" 			column="ACCT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="status"	 			column="STATUS"/>
		<result property="statusDesc"	 		column="STATUS_DESC"/>
		<result property="altNo"	 		    column="ALT_NO"/>
		
		<association property="project" 		resultMap="projectMap"/>	
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.CoInsurance" id="coInsuranceMap">
		<!-- <result property="policyNo"		column="POLICY_NO"/> -->
		<result property="policyId" 	column="POLICY_ID"/>
		<result property="policyNo" 	column="POLICY_NO"/>
		<result property="coRefNo"		column="CO_REF_NO"/>
		<result property="cedingId"		column="CEDING_ID"/>
		<result property="cedingName"	column="CEDING_NAME"/>
		<result property="pctShare"		column="PCT_SHARE"/>
		<result property="shareSiAmt"	column="SHARE_SI_AMT"/>
		<result property="sharePremAmt"	column="SHARE_PREM_AMT"/>
		<result property="createUser"	column="CREATE_USER"/>
		<result property="createDate"	column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser"	column="UPDATE_USER"/>
		<result property="updateDate"	column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolInwardBal" resultMap="retInwPolBalMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_INWARD_PKG.ret_pol_inward(#{policyId,jdbcType=INTEGER},#{policyNo,jdbcType=VARCHAR},null,null,null,null))
	</select>
	
	<select id="retrievePolCoInsurance" resultMap="coInsuranceMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_INSURANCE_PKG.ret_pol_insurance(#{policyId,jdbcType=INTEGER},#{policyNo,jdbcType=VARCHAR},null,null,null,null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="retrievePolCoinsuranceMap">
		<result property="policyId" 			column="POLICY_ID"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<association property="coInsurance" 	resultMap="coInsuranceMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Deductibles" id="PolDeductiblesMap">
		<result property="coverCd"			column="COVER_CD" />
		<result property="coverCdDesc"		column="COVER_DESC"/>
		<result property="endtCd"			column="ENDT_CD"/>
		<result property="endtTitle"		column="ENDT_TITLE"/>
		<result property="deductibleCd"		column="DED_CD"/>
		<result property="deductibleTitle"	column="DED_TITLE"/>
		<result property="deductibleRt"		column="DED_RT"/>
		<result property="deductibleAmt"	column="DED_AMT"/>
		<result property="deductibleTxt"	column="DED_TXT"/>
		<result property="createUser"		column="DED_CREATE_USER"/>
		<result property="createDate"		column="DED_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser"		column="DED_UPDATE_USER"/>
		<result property="updateDate"		column="DED_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Project" id="projectMap">
		<result property="projId" 		column="PROJ_ID"/>
		<result property="projDesc" 	column="PROJ_DESC"/>
		<result property="riskId" 		column="RISK_ID"/>
		<result property="riskName" 	column="RISK_NAME"/>
		<result property="regionCd" 	column="REGION_CD"/>
		<result property="regionDesc" 	column="REGION_DESC"/>
		<result property="provinceCd" 	column="PROVINCE_CD"/>
		<result property="provinceDesc" column="PROVINCE_DESC"/>
		<result property="cityCd" 		column="CITY_CD"/>
		<result property="cityDesc" 	column="CITY_DESC"/>
		<result property="districtCd" 	column="DISTRICT_CD"/>
		<result property="districtDesc" column="DISTRICT_DESC"/>
		<result property="blockCd" 		column="BLOCK_CD"/>
		<result property="blockDesc" 	column="BLOCK_DESC"/>
		<result property="latitude" 	column="LATITUDE"/>
		<result property="longitude" 	column="LONGITUDE"/>
		<result property="totalSi" 		column="TOTAL_SI"/>
		<result property="objectId" 	column="OBJECT_ID"/>
		<result property="objectDesc" 	column="OBJECT_DESC"/>
		<result property="site" 		column="SITE"/>
		<result property="duration" 	column="DURATION"/>
		<result property="testing" 		column="TESTING"/>
		<result property="ipl" 			column="IPL"/>
		<result property="timeExc" 		column="TIME_EXC"/>
		<result property="noClaimPd" 	column="NO_CLAIM_PD"/>
		<result property="createUser" 	column="PRJ_CREATE_USER"/>
		<result property="createDate" 	column="PRJ_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" 	column="PRJ_UPDATE_USER"/>
		<result property="updateDate" 	column="PRJ_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		
		<association property="coverage" resultMap="coverageMap"></association>
		<association property="fullCoverage" resultMap="fullCoverageMap"></association>
		<association property="items" resultMap="assocItemsMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Coverage" id="coverageMap">
		<result property="sectionISi" 			column="SECTION_I_SI"/>
		<result property="sectionIISi" 			column="SECTION_II_SI"/>
		<result property="sectionIIISi" 		column="SECTION_III_SI"/>
		<result property="totalSi" 				column="TOTAL_SI"/>
		<result property="sectionIPrem" 		column="SECTION_I_PREM"/>
		<result property="sectionIIPrem" 		column="SECTION_II_PREM"/>
		<result property="sectionIIIPrem" 		column="SECTION_III_PREM"/>
		<result property="totalPrem" 			column="TOTAL_PREM"/>
		<result property="holdCoverPremAmt" 	column="HOLD_COVER_PREM_AMT"/>
		<result property="currencyCd" 			column="CURRENCY_CD"/>
		<result property="currencyRt" 			column="CURRENCY_RT"/>
		<result property="pctShare" 			column="PCT_SHARE"/>
		<result property="pctPml" 				column="PCT_PML"/>
		<result property="totalValue" 			column="TOTAL_VALUE"/>
		<result property="remarks" 				column="REMARKS"/>
		<result property="exSeciPrem" 			column="EX_SECI_PREM"/>
		<result property="exSeciiPrem" 			column="EX_SECII_PREM"/>
		<result property="exSeciiiPrem" 		column="EX_SECIII_PREM"/>
		<result property="exTprem" 				column="EX_TPREM"/>
		<result property="exDays" 				column="EX_DAYS"/>
		<result property="totalDays" 			column="TOTAL_DAYS"/>
		<result property="cumSecISi" 			column="CUM_SECI_SI"/>
		<result property="cumSecIISi" 			column="CUM_SECII_SI"/>
		<result property="cumSecIIISi" 			column="CUM_SECIII_SI"/>
		<result property="cumTSi" 				column="CUM_TSI"/>
		<result property="cumSecIPrem" 			column="CUM_SECI_PREM"/>
		<result property="cumSecIIPrem" 		column="CUM_SECII_PREM"/>
		<result property="cumSecIIIPrem" 		column="CUM_SECIII_PREM"/>
		<result property="cumTPrem" 			column="CUM_TPREM"/>
		<result property="commRtQuota"     		column="COMM_RT_QUOTA"/>
		<result property="commRtSurplus" 		column="COMM_RT_SURPLUS"/>
		<result property="commRtFac"			column="COMM_RT_FAC"/>
		<result property="createUser" 			column="CREATE_USER"/>
		<result property="createDate" 			column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" 			column="UPDATE_USER"/>
		<result property="updateDate" 			column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="holdCoverTag" 		column="HOLD_COVER"/>
		<result property="extensionTag" 		column="EXTENSION_TAG"/>
		<association property="sectionCovers" resultMap ="sectionCoversMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.SectionCovers" id="sectionCoversMap">
		<result property="lineCd" 					column="LINE_CD"/>
		<result property="lineCdDesc" 				column="LINE_DESC"/>
		<result property="section" 					column="SECTION"/>
		<result property="coverCd" 					column="COVER_CD"/>
		<result property="coverName" 				column="COVER_NAME"/>
		<result property="bulletNo" 				column="BULLET_NO"/>
		<result property="prevSumInsured" 			column="PREV_SUM_INSURED"/>
		<result property="prevPremRt" 				column="PREV_PREM_RT"/>
		<result property="prevPremAmt" 				column="PREV_PREM_AMT"/>
		<result property="sumInsured" 				column="SUM_INSURED"/>
		<result property="premRt" 					column="PREM_RT"/>
		<result property="premAmt" 					column="PREM_AMT"/>
		<result property="addSi" 					column="ADD_SI"/>
		<result property="discountTag" 				column="DISCOUNT_TAG"/>
		<result property="exPremRt" 				column="EX_PREM_RT"/>
		<result property="exPremAmt" 				column="EX_PREM_AMT"/>
		<result property="exDiscTag" 				column="EX_DISC_TAG"/>
		<result property="cumSi" 					column="CUM_SI"/>
		<result property="cumPrem" 					column="CUM_PREM"/>	
		<result property="createUserSec" 			column="CREATE_USER_SEC"/>
		<result property="createDateSec" 			column="CREATE_DATE_SEC" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUserSec" 			column="UPDATE_USER_SEC"/>
		<result property="updateDateSec" 			column="UPDATE_DATE_SEC" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="deductiblesSec" resultMap="DeductibleMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Deductibles" id="DeductibleMap">
		<result property="coverCd" 			column="D_COVER_CD"/> 
		<result property="endtCd" 			column="D_ENDT_CD"/> 
		<result property="endtTitle" 		column="D_ENDT_TITLE"/> 
		<result property="deductibleCd"     column="D_DEDUCTIBLE_CD"/>
		<result property="deductibleTitle" 	column="D_DEDUCTIBLE_TITLE"/> 
		<result property="deductibleRt" 	column="D_DEDUCTIBLE_RT"/>
		<result property="deductibleAmt" 	column="D_DEDUCTIBLE_AMT"/>
		<result property="deductibleTxt" 	column="D_DEDUCTIBLE_TXT"/>
		<result property="createUser" 		column="D_CREATE_USER"/> 
		<result property="createDate" 		column="D_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="D_UPDATE_USER"/> 
		<result property="updateDate" 		column="D_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolicyDeductibles" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE (POL_DEDUCTIBLES_PKG.ret_pol_deductibles(#{policyId,jdbcType=VARCHAR},#{policyNo,jdbcType=VARCHAR},#{coverCd,jdbcType=VARCHAR},#{endtCd,jdbcType=VARCHAR},null,null,null,null))
	</select>
	
	<select id="retrievePolCoverage" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_COVERAGE_PKG.ret_pol_cover(#{policyId, jdbcType=VARCHAR},#{policyNo, jdbcType=VARCHAR},#{position, jdbcType=VARCHAR}, 
																	   #{count, jdbcType=VARCHAR}, 
																	   #{sortKey, jdbcType=VARCHAR}, 
																	   #{order, jdbcType=VARCHAR}))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="polAttachmentMap">
	    <result property="policyId" 		column="POLICY_ID"/> 
		<result property="policyNo" 		column="POLICY_NO"/> 
		<association property="attachments" resultMap="assocAttachmentMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Attachment" id="assocAttachmentMap">
		<result property="fileNo" 			column="FILE_NO"/> 
		<result property="fileName" 		column="FILE_NAME"/> 
		<result property="description" 		column="DESCRIPTION"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolAttachment" resultMap="polAttachmentMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_ATTACHMENT_PKG.ret_pol_attchmnt(#{policyId, jdbcType=INTEGER},
																	#{policyNo, jdbcType=VARCHAR},
																	#{position, jdbcType=VARCHAR}, 
																	#{count, jdbcType=VARCHAR}, 
																	#{sortKey, jdbcType=VARCHAR}, 
																	#{order, jdbcType=VARCHAR}))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="polEndtMap">
	    <result property="policyId" 		column="POLICY_ID"/> 
		<result property="policyNo" 		column="POLICY_NO"/> 
		<association property="endorsements" resultMap="assocEndorsementsMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Endorsements" id="assocEndorsementsMap">
		<result property="endtCd" 			column="ENDT_CD"/> 
		<result property="endtTitle" 		column="ENDT_TITLE"/> 
		<result property="changeTag" 		column="CHANGE_TAG"/>
		<result property="remarks" 			column="REMARKS"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="deductibles" resultMap="assocDeductiblesMap"></association>
		<association property="endtText" resultMap="EndtTextMapper"></association>
		
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Deductibles" id="assocDeductiblesMap">
		<result property="coverCd" 			column="D_COVER_CD"/> 
		<result property="endtCd" 			column="D_ENDT_CD"/> 
		<result property="endtTitle" 		column="D_ENDT_TITLE"/> 
		<result property="deductibleCd"     column="D_DEDUCTIBLE_CD"/>
		<result property="deductibleTitle" 	column="D_DEDUCTIBLE_TITLE"/> 
		<result property="deductibleRt" 	column="D_DEDUCTIBLE_RT"/>
		<result property="deductibleAmt" 	column="D_DEDUCTIBLE_AMT"/>
		<result property="deductibleTxt" 	column="D_DEDUCTIBLE_TXT"/>
		<result property="createUser" 		column="D_CREATE_USER"/> 
		<result property="createDate" 		column="D_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="D_UPDATE_USER"/> 
		<result property="updateDate" 		column="D_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolEndt" resultMap="polEndtMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_ENDT_PKG.ret_pol_endt(#{policyId, jdbcType=INTEGER},
														  #{policyNo, jdbcType=VARCHAR},
														  #{position, jdbcType=VARCHAR}, 
														  #{count, jdbcType=VARCHAR}, 
														  #{sortKey, jdbcType=VARCHAR}, 
														  #{order, jdbcType=VARCHAR}))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Item" id="assocItemsMap">
		<result property="itemNo" 			column="ITEM_NO"/> 
		<result property="quantity" 		column="QUANTITY"/> 
		<result property="itemDesc" 		column="ITEM_DESC"/> 
		<result property="makeYear" 		column="MAKE_YEAR"/> 
		<result property="deductibleTxt" 	column="DEDUCTIBLE_TXT"/> 
		<result property="sumInsured" 		column="SUM_INSURED"/> 
		<result property="stockType" 		column="STOCK_TYPE"/> 
	    <result property="serialNo"         column="SERIAL_NO"/> 
		<result property="location" 	    column="LOCATION"/> 
		<result property="chamberNo" 		column="CHAMBER_NO"/> 
		<result property="noClaimPd" 		column="NO_CLAIM_PD"/> 
		<result property="ipl" 	   			column="IPL"/> 
		<result property="relativeImp" 		column="RELATIVE_IMP"/> 
		<result property="standbyUnit" 		column="STANDBY_UNIT"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.CATPeril" id="assocCATPerilMap">
		<result property="catPrlId" 	    column="CAT_PERIL_ID"/>
		<result property="catPerilName" 	column="CAT_PERIL_NAME"/>  
		<result property="pctShrPrm" 	    column="PCT_SHARE_PREM"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="itemMap">
	    <result property="policyId" 		column="POLICY_ID"/> 
		<result property="policyNo" 		column="POLICY_NO"/> 
		<association property="project" resultMap="assocProjMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Project" id="assocProjMap">
	    <result property="projId" 		column="PROJ_ID"/>
		<result property="riskId" 		column="RISK_ID"/>
		<result property="riskName" 	column="RISK_NAME"/>
		<association property="items" resultMap="assocItemsMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="catPerilMap">
	    <result property="policyId" 		column="POLICY_ID"/> 
		<result property="policyNo" 		column="POLICY_NO"/> 
		<association property="catPeril" resultMap="assocCATPerilMap"></association>
	</resultMap>

	<select id="retrievePolItem" resultMap="itemMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_ITEM_PKG.ret_pol_itm(#{policyId, jdbcType=INTEGER},
																	#{policyNo, jdbcType=VARCHAR},
																	#{position, jdbcType=VARCHAR}, 
																	#{count, jdbcType=VARCHAR}, 
																	#{sortKey, jdbcType=VARCHAR}, 
																	#{order, jdbcType=VARCHAR}))
	</select>
	

	<select id="retrievePolCATPeril" resultMap="catPerilMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_CAT_PERIL_PKG.ret_pol_cat_prl(#{policyId, jdbcType=INTEGER},
																	#{policyNo, jdbcType=VARCHAR},
																	#{position, jdbcType=VARCHAR}, 
																	#{count, jdbcType=VARCHAR}, 
																	#{sortKey, jdbcType=VARCHAR}, 
																	#{order, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrievePolGenInfo" resultMap="policyMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_GEN_INFO_PKG.ret_pol_gen_info(#{policyId, jdbcType=INTEGER},
													     		  #{policyNo, jdbcType=VARCHAR}, 
													     	      null, 
													     		  null, 
													     		  null, 
													     		  null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Alop" id="assocAlop">
		<result property="insId" column="INS_ID"/>
		<result property="insuredName" column="INSURED_NAME"/>
		<result property="insuredDesc" column="INSURED_DESC"/>
		<result property="address" 			column="ADDRESS"/>
		<result property="insBusiness" 		column="INS_BUSINESS"/>
		<result property="annSi" 			column="ANN_SI"/>
		<result property="maxIndemPdSi" 	column="MAX_INDEM_PD_SI"/>
		<result property="issueDate" 		column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="expiryDate" 		column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="maxIndemPd" 		column="MAX_INDEM_PD"/>
		<result property="indemFromDate" 	column="INDEM_FROM_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="timeExc" 			column="TIME_EXC_ALOP"/>
		<result property="repInterval" 		column="REP_INTERVAL"/>
		<result property="createUser" 		column="CREATE_USER"/>
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" 		column="UPDATE_USER"/>
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="alopItem"	resultMap="assocAlopItem"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.AlopItem" id="assocAlopItem">
		<result property="itemNo"          	column="ITEM_NO"/>
		<result property="quantity" 		column="QUANTITY"/>
		<result property="description" 		column="DESCRIPTION"/>
		<result property="importance" 		column="IMPORTANCE"/>
		<result property="lossMin" 			column="LOSS_MIN"/>
		<result property="createUser" 		column="CREATE_USER"/>
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" 		column="UPDATE_USER"/>
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.HoldCover" id="holdCoverMap">
		<result property="policyId"				column="POLICY_ID" />
		<result property="holdCovId"			column="HOLD_COV_ID" />
		<result property="holdCovNo"			column="HOLD_COV_NO" />  
		<result property="lineCd"				column="LINE_CD" />
		<result property="holdCovYear"			column="HOLD_COV_YEAR" />
		<result property="holdCovSeqNo"			column="HOLD_COV_SEQ_NO" />
		<result property="holdCovRevNo"			column="HOLD_COV_REV_NO" />
		<result property="periodFrom"			column="PERIOD_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="periodTo"				column="PERIOD_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="compRefHoldCovNo"		column="COMP_REF_HOLD_COV_NO" />
		<result property="status"				column="STATUS" />
		<result property="statusDesc"			column="STATUS_DESC" />
		<result property="reqBy"				column="REQ_BY" />
		<result property="reqDate"				column="REQ_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="preparedBy"			column="PREPARED_BY" />
		<result property="approvedBy"			column="APPROVED_BY" />
		<result property="createUser"			column="CREATE_USER" />
		<result property="createDate"			column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser"			column="UPDATE_USER" />
		<result property="updateDate"			column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap> 
	
	<select id="retrievePolAlop" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_ALOP_PKG.ret_pol_alop(#{policyId, jdbcType=INTEGER}, 
													  #{policyNo, jdbcType=VARCHAR},
																	  null, 
																      null, 
																	  null, 
																	  null))
	</select>
	
	
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="retrievePolAlopItemPolicyMap">
		<result property="policyId" 			column="POLICY_ID"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<association property="alop" resultMap="retrievePolAlopItemAlopMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Alop" id="retrievePolAlopItemAlopMap">
		<result property="insId" column="INS_ID"/>
		<result property="insuredDesc" column="INSURED_DESC"/>
		<association property="alopItem" resultMap="assocAlopItem"/>
	</resultMap>
	
	<select id="retrievePolAlopItem" resultMap="retrievePolAlopItemPolicyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_ALOP_ITEM_PKG.ret_pol_alop_item(#{policyId, jdbcType=INTEGER},
			#{policyNo, jdbcType=VARCHAR}, null, null, null, null))
	</select>
	
	<update id="savePolAttachment" parameterType="java.util.Map">
		BEGIN
		   <foreach collection="savePolAttachments" item="attachment">
		   	   POL_ATTACHMENT_PKG.save_pol_attchmnt(#{policyId},
		   	   										#{attachment.fileNo, jdbcType=VARCHAR},
		   	   										#{attachment.fileName},
		   	   										#{attachment.description, jdbcType=VARCHAR},
		   	   										#{attachment.createUser},
			   										CAST(to_timestamp(#{attachment.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
			   										#{attachment.updateUser},
			   										CAST(to_timestamp(#{attachment.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
		   </foreach>
		   <foreach collection="deletePolAttachments" item="attachment">
		   		POL_ATTACHMENT_PKG.del_pol_attchmnt(#{policyId},
		   											#{attachment.fileNo, jdbcType=VARCHAR});
		   </foreach>
		END;
	</update>

	
	<update id="savePolicyDeductibles" parameterType="java.util.Map">
		BEGIN
			<foreach collection="deleteDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.del_pol_deductibles(
		   			#{policyId},#{deductible.coverCd},#{deductible.endtCd},#{deductible.deductibleCd,jdbcType=VARCHAR}
		   		);
		    </foreach>
			<foreach collection="saveDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.save_pol_deductibles(
		   			#{policyId},#{deductible.coverCd,jdbcType=VARCHAR},#{deductible.endtCd},#{deductible.deductibleCd},#{deductible.deductibleRt,jdbcType=VARCHAR},
		   			#{deductible.deductibleAmt,jdbcType=VARCHAR},#{deductible.deductibleTxt},#{deductible.createUser},
		   			CAST(to_timestamp(#{deductible.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{deductible.updateUser},
				   	CAST(to_timestamp(#{deductible.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE) 
		   		);
		   	</foreach>
		END;
	</update>
	
	<update id="savePolAlopMap" parameterType="java.util.Map">
		BEGIN
			POL_ALOP_PKG.save_pol_alop(#{policyId},#{insId},#{insuredDesc},#{address},#{insBusiness,jdbcType=VARCHAR},#{annSi},#{maxIndemPdSi},
			   CAST(to_timestamp(#{issueDate,jdbcType=DATE}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), 
			   CAST(to_timestamp(#{expiryDate,jdbcType=DATE}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), #{maxIndemPd}, 
			   CAST(to_timestamp(#{indemFromDate,jdbcType=DATE}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
			   #{timeExc}, #{repInterval}, #{createUser},
			   CAST(to_timestamp(#{createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{updateUser},
			   CAST(to_timestamp(#{updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
		END;
	</update>
	
	<update id="savePolAlopItemMap" parameterType="java.util.Map">
		BEGIN
			<foreach collection="deletePolAlopItemList" item="alopItem">
			BEGIN
		    	POL_ALOP_ITEM_PKG.del_pol_alop_item(#{policyId},#{alopItem.itemNo, jdbcType=INTEGER});
			END;
			</foreach>
			<foreach collection="savePolAlopItemList" item="alopItem">
			    	POL_ALOP_ITEM_PKG.save_pol_alop_item
			    	(#{policyId},#{alopItem.itemNo, jdbcType=VARCHAR},#{alopItem.quantity, jdbcType=INTEGER},
			    	#{alopItem.description},#{alopItem.importance, jdbcType=VARCHAR},#{alopItem.lossMin, jdbcType=VARCHAR},
			    	#{alopItem.createUser},
			    	CAST(to_timestamp(#{alopItem.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
			    	#{alopItem.updateUser},CAST(to_timestamp(#{alopItem.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS.ff3"Z"') AS DATE));
			</foreach>
		END;
	</update>
			    	
			    	
	<update id="savePolCATPeril" parameterType="java.util.Map">
		BEGIN
		  <foreach collection="saveCATPerilList" item="CATPeril">
			POL_CAT_PERIL_PKG.save_pol_cat_prl(
				#{policyId, jdbcType=INTEGER},
				#{CATPeril.catPrlId, jdbcType=INTEGER},
				#{CATPeril.pctShrPrm, jdbcType=INTEGER},
				#{CATPeril.createUser, jdbcType=VARCHAR},
				CAST(to_timestamp(#{CATPeril.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS.ff3"Z"') AS DATE),
				#{CATPeril.updateUser, jdbcType=VARCHAR},
				CAST(to_timestamp(#{CATPeril.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS.ff3"Z"') AS DATE)
			);
			</foreach>
		END;
	</update>
	
	<update id="savePolCoverage" parameterType="java.util.Map">
		BEGIN
			POL_COVERAGE_PKG.save_pol_cover( #{policyId},#{projId},#{riskId},#{sectionISi}, #{sectionIISi}, #{sectionIIISi}, #{totalSi},
										   #{sectionIPrem}, #{sectionIIPrem}, #{sectionIIIPrem}, 
										   #{totalPrem},#{holdCoverPremAmt,jdbcType=VARCHAR}, #{currencyCd}, #{currencyRt}, #{pctShare}, 
										   #{pctPml, jdbcType=VARCHAR}, #{totalValue}, #{remarks, jdbcType=VARCHAR},
										   #{exSecIPrem, jdbcType=INTEGER}, #{exSecIIPrem, jdbcType=INTEGER}, 
										   #{exSecIIIPrem, jdbcType=INTEGER}, #{extotalPrem, jdbcType=INTEGER}, 
										   #{exDays, jdbcType=INTEGER}, #{totalDays, jdbcType=INTEGER}, #{cumSecISi}, 
										   #{cumSecIISi}, #{cumSecIIISi}, #{cumTSi}, 
										   #{cumSecIPrem}, #{cumSecIIPrem}, #{cumSecIIIPrem}, #{cumTPrem}, #{commRtQuota},#{commRtSurplus},#{commRtFac}, #{createUser}, 
										    CAST(to_timestamp(#{createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), 
										   #{updateUser},  CAST(to_timestamp(#{updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			
			<foreach collection="deleteSectionCovers" item="sectioncovers">
				POL_SEC_COVER_PKG.del_pol_cover(#{policyId},#{projId},#{riskId},#{sectioncovers.lineCd}, 
													#{sectioncovers.section}  ,#{sectioncovers.coverCd});
			</foreach>
			
			<foreach collection="saveSectionCovers" item="sectioncovers">
				POL_SEC_COVER_PKG.save_pol_sec_cvrs(#{policyId},#{projId},#{riskId},#{sectioncovers.lineCd}, 
													#{sectioncovers.section}  ,#{sectioncovers.coverCd} , #{sectioncovers.coverName},
													#{sectioncovers.bulletNo},#{sectioncovers.sumInsured},
													#{sectioncovers.premRt},#{sectioncovers.premAmt},
													#{sectioncovers.addSi}, #{sectioncovers.discountTag, jdbcType=VARCHAR}, 
													#{sectioncovers.exPremRt, jdbcType=INTEGER}, #{sectioncovers.exPremAmt, jdbcType=INTEGER},
													#{sectioncovers.cumSi}, #{sectioncovers.cumPrem}, 
													#{sectioncovers.createUserSec},
													CAST(to_timestamp(#{sectioncovers.createDateSec}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
													#{sectioncovers.updateUserSec}, CAST(to_timestamp(#{sectioncovers.createDateSec}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			</foreach>
			
			<foreach collection="deleteDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.del_pol_deductibles(
		   			#{policyId},#{deductible.coverCd},#{deductible.endtCd},#{deductible.deductibleCd,jdbcType=VARCHAR}
		   		);
		    </foreach>
		    
			<foreach collection="saveDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.save_pol_deductibles(
		   			#{policyId},#{deductible.coverCd,jdbcType=VARCHAR},#{deductible.endtCd},#{deductible.deductibleCd},#{deductible.deductibleRt,jdbcType=VARCHAR},
		   			#{deductible.deductibleAmt,jdbcType=VARCHAR},#{deductible.deductibleTxt},#{deductible.createUser},
		   			CAST(to_timestamp(#{deductible.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{deductible.updateUser},
				   	CAST(to_timestamp(#{deductible.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE) 
		   		);
		   	</foreach>
		   	
		   	POL_ENDT_PKG.add_vib_endt(#{policyId},#{updateUser},#{changeTag,jdbcType=VARCHAR});
		END;
	</update>
	
	<update id="savePolHoldCover" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POL_HOLD_COVER_PKG.save_pol_hc(
				 #{polHoldCoverNo, mode=OUT, jdbcType=VARCHAR},
				 #{polHoldCoverId, mode=OUT, jdbcType=INTEGER},
				 #{policyId, jdbcType=VARCHAR},
				 #{holdCovId, jdbcType=VARCHAR},
				 #{lineCd},
				 #{holdCovYear},
				 #{holdCovSeqNo, jdbcType=VARCHAR},
				 #{holdCovRevNo, jdbcType=VARCHAR},
				 CAST(to_timestamp(#{periodFrom}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				 CAST(to_timestamp(#{periodTo}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				 #{compRefHoldCovNo, jdbcType=VARCHAR},
				 #{status, jdbcType=VARCHAR},
				 #{reqBy, jdbcType=VARCHAR},
				 CAST(to_timestamp(#{reqDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				 #{preparedBy, jdbcType=VARCHAR},
				 #{approvedBy, jdbcType=VARCHAR},
				 #{createUser},
				 CAST(to_timestamp(#{createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				 #{updateUser},
				 CAST(to_timestamp(#{updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
			);
		END;
	</update>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.PolicyOc" id="polAttachmentOcMap">
	    <result property="policyIdOc" 		column="POLICY_ID_OC"/> 
		<result property="openPolicyNo" 	column="OPEN_POLICY_NO"/> 
		
		<association property="attachmentsOc" resultMap="assocAttachmentOcMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.AttachmentOc" id="assocAttachmentOcMap">
		<result property="fileNo" 			column="FILE_NO"/> 
		<result property="fileName" 		column="FILE_NAME"/> 
		<result property="description" 		column="DESCRIPTION"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolAttachmentOc" resultMap="polAttachmentOcMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_ATTACHMENT_OC_PKG.ret_pol_att_oc(#{policyIdOc, jdbcType=INTEGER},
																	 #{openPolicyNo, jdbcType=VARCHAR},
																	 #{position, jdbcType=VARCHAR}, 
																	 #{count, jdbcType=VARCHAR}, 
																	 #{sortKey, jdbcType=VARCHAR}, 
																	 #{order, jdbcType=VARCHAR}))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.PolicyOc" id="polEndtOcMap">
	    <result property="policyIdOc" 		column="POLICY_ID_OC"/> 
		<result property="openPolicyNo"     column="OPEN_POLICY_NO"/> 
		<association property="endorsementsOc" resultMap="assocEndorsementsOcMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.EndtOc" id="assocEndorsementsOcMap">
		<result property="endtCd" 			column="ENDT_CD"/> 
		<result property="endtTitle" 		column="ENDT_TITLE"/> 
		<result property="changeTag" 		column="CHANGE_TAG"/>
		<result property="remarks" 			column="REMARKS"/> 
		<result property="createUser" 		column="CREATE_USER"/> 
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="UPDATE_USER"/> 
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="deductiblesOc" resultMap="assocDeductiblesOcMap"></association>
		<association property="endtText" resultMap="EndtTextMapper"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.DeductiblesOc" id="assocDeductiblesOcMap">
		<result property="endtCd" 			column="D_ENDT_CD"/> 
		<result property="endtTitle" 		column="D_ENDT_TITLE"/> 
		<result property="deductibleCd"     column="D_DEDUCTIBLE_CD"/>
		<result property="deductibleTitle" 	column="D_DEDUCTIBLE_TITLE"/> 
		<result property="deductibleRt" 	column="D_DEDUCTIBLE_RT"/>
		<result property="deductibleAmt" 	column="D_DEDUCTIBLE_AMT"/>
		<result property="deductibleTxt" 	column="D_DEDUCTIBLE_TXT"/>
		<result property="createUser" 		column="D_CREATE_USER"/> 
		<result property="createDate" 		column="D_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser" 		column="D_UPDATE_USER"/> 
		<result property="updateDate" 		column="D_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolEndtOc" resultMap="polEndtOcMap" parameterType="java.util.Map">
			SELECT * FROM TABLE(POL_ENDT_OC_PKG.ret_pol_endt_oc(#{policyIdOc, jdbcType=INTEGER},
														  		#{openPolicyNo, jdbcType=VARCHAR},
														  		#{position, jdbcType=VARCHAR}, 
														  		#{count, jdbcType=VARCHAR}, 
														  		#{sortKey, jdbcType=VARCHAR}, 
														  		#{order, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrievePolicyListing" resultMap="policyListingMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_GEN_INFO_PKG.ret_pol_listing(#{policyNo, jdbcType=VARCHAR},
															 #{cessionDesc, jdbcType=VARCHAR},
															 #{cedingName, jdbcType=VARCHAR},
															 #{lineClassDesc, jdbcType=VARCHAR},
															 #{insuredDesc, jdbcType=VARCHAR},
															 #{riskName, jdbcType=VARCHAR},
															 #{objectDesc, jdbcType=VARCHAR},
															 #{site, jdbcType=VARCHAR},
															 #{currencyCd, jdbcType=VARCHAR},
															 #{totalSiLess, jdbcType=DECIMAL},
															 #{totalSiGrt, jdbcType=DECIMAL},
															 #{totalPremLess, jdbcType=DECIMAL},
															 #{totalPremGrt, jdbcType=DECIMAL},
															 CAST(to_timestamp(#{issueDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{issueDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{inceptDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{inceptDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{expiryDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{expiryDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{acctDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{acctDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 #{statusDesc, jdbcType=VARCHAR},
															 null,
															 null,
															 null,
															 null))
	</select> 
	
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.Policy" id="retPolHoldCoverMap">
		<result property="policyId" 			column="POLICY_ID"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<result property="cedingName" 			column="CEDING_NAME"/>
		<result property="principalName" 		column="INSURED_NAME"/>
		<association property="project" 		resultMap="projectMap"/>
		<collection property="holdCoverList" javaType="ArrayList" column="{policyId = POLICY_ID, holdCovId = HOLD_COV_ID}" ofType="holdCoverMap" select="retrievePolHoldCover"/>
	</resultMap>
	
	<select id="retrievePolHoldCoverMain" resultMap="retPolHoldCoverMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_HOLD_COVER_PKG.RET_POL_HOLD_COVER(#{policyId, jdbcType=VARCHAR},
															      #{policyNo, jdbcType=VARCHAR},
															      #{holdCovId, jdbcType=VARCHAR},
															      #{position, jdbcType=VARCHAR}, 
																  #{count, jdbcType=VARCHAR}, 
																  #{sortKey, jdbcType=VARCHAR}, 
																  #{order, jdbcType=VARCHAR}))
	   ORDER BY HOLD_COV_ID DESC
	</select>
	
	<select id="retrievePolHoldCover" resultMap="holdCoverMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_HOLD_COVER_PKG.RET_POL_HOLD_COVER(#{policyId, jdbcType=VARCHAR},
															      #{policyNo, jdbcType=VARCHAR},
															      #{holdCovId, jdbcType=VARCHAR},
															      #{position, jdbcType=VARCHAR}, 
																  #{count, jdbcType=VARCHAR}, 
																  #{sortKey, jdbcType=VARCHAR}, 
																  #{order, jdbcType=VARCHAR}))
	</select>
	
	<update id="savePolItem" parameterType="java.util.Map">
		BEGIN
		
		  <foreach collection="deleteItemLists" item="Items">
		  	POL_ITEM_PKG.del_pol_itm(#{policyId},
				#{projId},#{Items.itemNo});
		  </foreach>
		  
		  <foreach collection="saveItemLists" item="Items">
			POL_ITEM_PKG.save_pol_itm(
				#{policyId},
				#{projId},
				#{Items.itemNo, jdbcType=INTEGER},
				#{Items.quantity, jdbcType=INTEGER},
				#{Items.itemDesc, jdbcType=VARCHAR},
				#{Items.makeYear, jdbcType=VARCHAR},
				#{Items.deductibleTxt, jdbcType=VARCHAR},
				#{Items.sumInsured, jdbcType=INTEGER},
				#{Items.stockType, jdbcType=VARCHAR},
				#{Items.serialNo, jdbcType=VARCHAR},
				#{Items.location, jdbcType=VARCHAR},
				#{Items.chamberNo, jdbcType=VARCHAR},
				#{Items.noClaimPd, jdbcType=INTEGER},
				#{Items.ipl, jdbcType=INTEGER},
				#{Items.relativeImp, jdbcType=VARCHAR},
				#{Items.standbyUnit, jdbcType=VARCHAR},
				#{Items.createUser, jdbcType=VARCHAR},
				CAST(to_timestamp(#{Items.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				#{Items.updateUser, jdbcType=VARCHAR},
				CAST(to_timestamp(#{Items.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
			);
			</foreach>
			POL_ITEM_PKG.renumber_pol_itm(#{policyId},#{projId});
		END;
	</update>
	
	<update id="savePolGenInfo" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POL_GEN_INFO_PKG.save_pol_gen_info(#{policyNo, mode=OUT, jdbcType=VARCHAR},
											   #{outPolicyId, mode=OUT, jdbcType=INTEGER},
											   #{savingType, jdbcType=VARCHAR},
											   #{refPolicyId, jdbcType=INTEGER},
											   #{policyId, jdbcType=INTEGER},
											   #{lineCd, jdbcType=VARCHAR},
											   #{polYear, jdbcType=INTEGER},
											   #{polSeqNo, jdbcType=INTEGER},
											   #{cedingId, jdbcType=VARCHAR},
											   #{coSeriesNo, jdbcType=INTEGER},
											   #{altNo, jdbcType=INTEGER},
											   #{cessionId, jdbcType=INTEGER},
											   #{lineClassCd, jdbcType=VARCHAR},
											   #{quoteId, jdbcType=INTEGER},
											   #{optionId, jdbcType=INTEGER},
											   #{status, jdbcType=VARCHAR},
											   #{coRefNo, jdbcType=VARCHAR},
											   #{reinsurerId, jdbcType=VARCHAR},
											   #{riBinderNo, jdbcType=VARCHAR},
											   #{mbiRefNo, jdbcType=VARCHAR},
											   #{policyIdOc, jdbcType=INTEGER},
											   #{refOpenPolNo, jdbcType=VARCHAR},
											   #{intmId, jdbcType=INTEGER},
											   #{principalId, jdbcType=INTEGER},
											   #{contractorId, jdbcType=INTEGER},
											   #{insuredDesc, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{inceptDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{expiryDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{lapseFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{lapseTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{maintenanceFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{maintenanceTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{issueDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{effDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{distDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   CAST(to_timestamp(#{acctDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   #{currencyCd, jdbcType=VARCHAR},
											   #{currencyRt, jdbcType=FLOAT},
											   #{bookedTag, jdbcType=VARCHAR},
											   #{govtTag, jdbcType=VARCHAR},
											   #{openCoverTag, jdbcType=VARCHAR},
											   #{holdCoverTag, jdbcType=VARCHAR},
											   #{declarationTag, jdbcType=VARCHAR},
											   #{minDepTag, jdbcType=VARCHAR},
											   #{altTag, jdbcType=VARCHAR},
											   #{specialPolicyTag, jdbcType=VARCHAR},
											   #{instTag, jdbcType=VARCHAR},
											   #{extensionTag, jdbcType=VARCHAR},
											   #{excludeDistTag, jdbcType=VARCHAR},
											   #{coinsGrpId, jdbcType=INTEGER},
											   #{wordings, jdbcType=VARCHAR},
											   #{createUser, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   #{updateUser, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   #{projId, jdbcType=INTEGER},
											   #{projDesc, jdbcType=VARCHAR},
											   #{riskId, jdbcType=INTEGER},
											   #{totalSi, jdbcType=DECIMAL},
											   #{objectId, jdbcType=VARCHAR},
											   #{site, jdbcType=VARCHAR},
											   #{duration, jdbcType=VARCHAR},
											   #{testing, jdbcType=VARCHAR},
											   #{ipl, jdbcType=INTEGER},
											   #{timeExc, jdbcType=INTEGER},
											   #{noClaimPd, jdbcType=INTEGER},
											   #{prjCreateUser, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{prjCreateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   #{prjUpdateUser, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{prjUpdateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   #{regionCd},#{provinceCd},#{cityCd},#{districtCd, jdbcType=VARCHAR},#{blockCd, jdbcType=VARCHAR},
											   #{latitude, jdbcType=VARCHAR},#{longitude, jdbcType=VARCHAR}
			);
			
			<!-- POL_WORDINGS_PKG.save_pol_wordings(
				#{policyId, jdbcType=INTEGER},
				#{polWordings.wordingCd, jdbcType=VARCHAR},
				#{polWordings.polwText01, jdbcType=VARCHAR},
				#{polWordings.polwText02, jdbcType=VARCHAR},
				#{polWordings.polwText03, jdbcType=VARCHAR},
				#{polWordings.polwText04, jdbcType=VARCHAR},
				#{polWordings.polwText05, jdbcType=VARCHAR},
				#{polWordings.polwText06, jdbcType=VARCHAR},
				#{polWordings.polwText07, jdbcType=VARCHAR},
				#{polWordings.polwText08, jdbcType=VARCHAR},
				#{polWordings.polwText09, jdbcType=VARCHAR},
				#{polWordings.polwText10, jdbcType=VARCHAR},
				#{polWordings.polwText11, jdbcType=VARCHAR},
				#{polWordings.polwText12, jdbcType=VARCHAR},
				#{polWordings.polwText13, jdbcType=VARCHAR},
				#{polWordings.polwText14, jdbcType=VARCHAR},
				#{polWordings.polwText15, jdbcType=VARCHAR},
				#{polWordings.polwText16, jdbcType=VARCHAR},
				#{polWordings.polwText17, jdbcType=VARCHAR},
				#{polWordings.createUser, jdbcType=VARCHAR},
			   CAST(to_timestamp(#{polWordings.createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
			   #{updateUser, jdbcType=VARCHAR},
			   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
			); -->
		END;
	</update>
		
	<update id="savePolGenInfoWordings" parameterType="java.util.Map">
		BEGIN
			POL_WORDINGS_PKG.save_pol_wordings(
					#{policyId, jdbcType=INTEGER},
					<!-- #{polWordings.wordingCd, jdbcType=VARCHAR}, -->
					#{polWordings.polwText01, jdbcType=VARCHAR},
					#{polWordings.polwText02, jdbcType=VARCHAR},
					#{polWordings.polwText03, jdbcType=VARCHAR},
					#{polWordings.polwText04, jdbcType=VARCHAR},
					#{polWordings.polwText05, jdbcType=VARCHAR},
					#{polWordings.polwText06, jdbcType=VARCHAR},
					#{polWordings.polwText07, jdbcType=VARCHAR},
					#{polWordings.polwText08, jdbcType=VARCHAR},
					#{polWordings.polwText09, jdbcType=VARCHAR},
					#{polWordings.polwText10, jdbcType=VARCHAR},
					#{polWordings.polwText11, jdbcType=VARCHAR},
					#{polWordings.polwText12, jdbcType=VARCHAR},
					#{polWordings.polwText13, jdbcType=VARCHAR},
					#{polWordings.polwText14, jdbcType=VARCHAR},
					#{polWordings.polwText15, jdbcType=VARCHAR},
					#{polWordings.polwText16, jdbcType=VARCHAR},
					#{polWordings.polwText17, jdbcType=VARCHAR},
					#{polWordings.altwText01, jdbcType=VARCHAR},
					#{polWordings.altwText02, jdbcType=VARCHAR},
					#{polWordings.altwText03, jdbcType=VARCHAR},
					#{polWordings.altwText04, jdbcType=VARCHAR},
					#{polWordings.altwText05, jdbcType=VARCHAR},
					#{polWordings.altwText06, jdbcType=VARCHAR},
					#{polWordings.altwText07, jdbcType=VARCHAR},
					#{polWordings.altwText08, jdbcType=VARCHAR},
					#{polWordings.altwText09, jdbcType=VARCHAR},
					#{polWordings.altwText10, jdbcType=VARCHAR},
					#{polWordings.altwText11, jdbcType=VARCHAR},
					#{polWordings.altwText12, jdbcType=VARCHAR},
					#{polWordings.altwText13, jdbcType=VARCHAR},
					#{polWordings.altwText14, jdbcType=VARCHAR},
					#{polWordings.altwText15, jdbcType=VARCHAR},
					#{polWordings.altwText16, jdbcType=VARCHAR},
					#{polWordings.altwText17, jdbcType=VARCHAR},
					#{polWordings.createUser, jdbcType=VARCHAR},
				   CAST(to_timestamp(#{polWordings.createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				   #{updateUser, jdbcType=VARCHAR},
				   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
				);
		END;
	</update>

	<select id="retrievePolicyInformation" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_GEN_INFO_PKG.ret_pol_info(#{policyId, jdbcType=VARCHAR},#{policyNo, jdbcType=VARCHAR},null,null,null,null))
	</select>
	
	<update id="savePolInwardBal" parameterType="java.util.Map">
		DECLARE
			v_instNo POL_INWARD_BAL.INST_NO%TYPE;
		BEGIN
			<foreach collection="delPolInward" item="polInward">
				POL_INWARD_PKG.del_inw(#{policyId},#{polInward.instNo});
			</foreach>
			<foreach collection="delOtherCharges" item="otherCharges">
				POL_INWARD_PKG.del_oth_charges(#{policyId},#{otherCharges.instNo},#{otherCharges.chargeCd});
			</foreach>
			<foreach collection="savePolInward" item="polInward">
				POL_INWARD_PKG.save_inw(#{policyId},#{polInward.instNo},
						CAST(to_timestamp(#{polInward.dueDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
						CAST(to_timestamp(#{polInward.bookingDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
						#{polInward.premAmt}, #{polInward.commRt}, #{polInward.commAmt}, 
						#{polInward.otherChargesInw}, #{polInward.amtDue},#{polInward.createUser},
						CAST(to_timestamp(#{polInward.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{polInward.updateUser},
						CAST(to_timestamp(#{polInward.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			</foreach>
			<foreach collection="saveOtherCharges" item="otherCharges">
					POL_INWARD_PKG.save_oth_charges(#{policyId},#{otherCharges.instNo},#{otherCharges.chargeCd},#{otherCharges.amount},
							#{otherCharges.createUser},
							CAST(to_timestamp(#{otherCharges.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{otherCharges.updateUser},
							CAST(to_timestamp(#{otherCharges.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			</foreach>
			
			<foreach collection="newSavePolInward" item="polInward">
				v_instNo := #{polInward.instNo,jdbcType=VARCHAR};
				POL_INWARD_PKG.save_inw(#{policyId},v_instNo,
						CAST(to_timestamp(#{polInward.dueDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
						CAST(to_timestamp(#{polInward.bookingDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
						#{polInward.premAmt},#{polInward.commRt}, #{polInward.commAmt}, 
						#{polInward.otherChargesInw},#{polInward.amtDue},#{polInward.createUser},
						CAST(to_timestamp(#{polInward.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{polInward.updateUser},
						CAST(to_timestamp(#{polInward.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
				<foreach collection="polInward.otherCharges" item="otherCharges">
					POL_INWARD_PKG.save_oth_charges(#{policyId},v_instNo,#{otherCharges.chargeCd},#{otherCharges.amount},
							#{otherCharges.createUser},
							CAST(to_timestamp(#{otherCharges.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{otherCharges.updateUser},
							CAST(to_timestamp(#{otherCharges.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
				</foreach>
			</foreach>
			POL_INWARD_PKG.chk_inst_tag(#{policyId});
			POL_INWARD_PKG.add_inst_endt(#{policyId},#{user});
		END;
	</update>

	<resultMap type="ph.cpi.rest.api.model.underwriting.OpenPolicy" id="policyOcMap">
		<result property="policyId" 			column="POLICY_ID_OC"/>
		<result property="policyNo" 			column="POLICY_NO"/>
		<association property="projectOc" 		resultMap="projectOcMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ProjectOc" id="projectOcMap">
		<result property="riskId" 		column="RISK_ID"/>
		<result property="riskName" 	column="RISK_NAME"/>
		<association property="coverageOc" 		resultMap="coverageOcMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.CoverageOc" id="coverageOcMap">
		<result property="sectionISi" column="SECTION_I_SI"/>
		<result property="sectionIISi" column="SECTION_II_SI"/>
		<result property="sectionIIISi" column="SECTION_III_SI"/>
		<result property="totalSi" column="TOTAL_SI"/>
		<result property="sectionIPrem" column="SECTION_I_PREM"/>
		<result property="sectionIIPrem" column="SECTION_II_PREM"/>
		<result property="sectionIIIPrem" column="SECTION_III_PREM"/>
		<result property="totalPrem" column="TOTAL_PREM"/>
		<result property="currencyCd" column="CURRENCY_CD"/>
		<result property="currencyRt" column="CURRENCY_RT"/>
		<result property="pctShare" column="PCT_SHARE"/>
		<result property="pctPml" column="PCT_PML"/>
		<result property="totalValue" column="TOTAL_VALUE"/>
		<result property="remarks" column="REMARKS"/>
		<result property="createUser" column="CREATE_USER"/>
		<result property="createDate" column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" column="UPDATE_USER"/>
		<result property="updateDate" column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="sectionCoversOc" 		resultMap="sectionCoversOcMap"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.SectionCoversOc" id="sectionCoversOcMap">
		<result property="lineCd" column="LINE_CD"/>
		<result property="lineCdDesc" column="LINE_DESC"/>
		<result property="section" column="SECTION"/>
		<result property="coverCd" column="COVER_CD"/>
		<result property="description" column="DESCRIPTION"/>
		<result property="bulletNo" column="BULLET_NO"/>
		<result property="sumInsured" column="SUM_INSURED"/>
		<result property="premRt" column="PREM_RT"/>
		<result property="premAmt" column="PREM_AMT"/>
		<result property="addSi" column="ADD_SI"/>
		<result property="createUserSec" column="CREATE_USER_SEC"/>
		<result property="createDateSec" column="CREATE_DATE_SEC" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUserSec" column="UPDATE_USER_SEC"/>
		<result property="updateDateSec" column="UPDATE_DATE_SEC" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<select id="retrievePolCoverageOc" resultMap="policyOcMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_COVERAGE_OC_PKG.ret_pol_cov_oc(#{policyId, jdbcType=VARCHAR},#{policyNo, jdbcType=VARCHAR},#{position, jdbcType=VARCHAR}, 
																	   #{count, jdbcType=VARCHAR}, 
																	   #{sortKey, jdbcType=VARCHAR}, 
																	   #{order, jdbcType=VARCHAR}))
	</select>
	
	<update id="savePolCoverageOc" parameterType="java.util.Map">
		BEGIN
			POL_COVERAGE_OC_PKG.save_pol_cover_oc( #{policyIdOc},#{projId},#{riskId},#{sectionISi}, #{sectionIISi}, #{sectionIIISi}, #{totalSi},
										   #{sectionIPrem}, #{sectionIIPrem}, #{sectionIIIPrem}, 
										   #{totalPrem}, #{currencyCd}, #{currencyRt}, #{pctShare}, 
										   #{pctPml}, #{totalValue}, #{remarks}, #{createUser}, 
										    CAST(to_timestamp(#{createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), 
										    #{updateUser},  CAST(to_timestamp(#{updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
										   
			<foreach collection="delSectionCoversOc" item="sectioncovers">
				POL_SEC_COVER_OC_PKG.del_pol_cover_oc (#{policyIdOc},#{projId},#{riskId},#{sectioncovers.lineCd}, 
													#{sectioncovers.section}  ,#{sectioncovers.coverCd});
			</foreach>
			
			<foreach collection="saveSectionCoversOc" item="sectioncovers">
				POL_SEC_COVER_OC_PKG.save_pol_sec_cvrs_oc(#{policyIdOc},#{projId},#{riskId},#{sectioncovers.lineCd}, 
													#{sectioncovers.section}  ,#{sectioncovers.coverCd} ,
													#{sectioncovers.bulletNo},#{sectioncovers.sumInsured},
													#{sectioncovers.premRt},#{sectioncovers.premAmt},
													#{sectioncovers.addSi},#{sectioncovers.createUserSec},
													CAST(to_timestamp(#{sectioncovers.createDateSec}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
													#{sectioncovers.updateUserSec}, CAST(to_timestamp(#{sectioncovers.createDateSec}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			</foreach>
		END;
	</update>
	
	<update id="savePolEndtOc" parameterType="java.util.Map">
		BEGIN
			<foreach collection="deleteEndorsements" item="endo">
				POL_ENDT_OC_PKG.del_pol_endt_dedt_oc(#{policyId},#{endo.endtCd});
			</foreach>
			<foreach collection="saveEndorsements" item="endo">
				POL_ENDT_OC_PKG.save_pol_endt_oc(
					#{policyId},#{endo.endtCd},#{endo.changeTag,jdbcType=VARCHAR},
					#{endo.remarks,jdbcType=VARCHAR},#{endo.createUser},
		   			CAST(to_timestamp(#{endo.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
		   			#{endo.updateUser},
				   	CAST(to_timestamp(#{endo.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE) ,
				   	#{endo.endtText.endtText01, jdbcType=VARCHAR},	#{endo.endtText.endtText02, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText03, jdbcType=VARCHAR},	#{endo.endtText.endtText04, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText05, jdbcType=VARCHAR},	#{endo.endtText.endtText06, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText07, jdbcType=VARCHAR},	#{endo.endtText.endtText08, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText09, jdbcType=VARCHAR},	#{endo.endtText.endtText10, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText11, jdbcType=VARCHAR},	#{endo.endtText.endtText12, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText13, jdbcType=VARCHAR},	#{endo.endtText.endtText14, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText15, jdbcType=VARCHAR},	#{endo.endtText.endtText16, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText17, jdbcType=VARCHAR}
				);
			</foreach>
			<foreach collection="deleteDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_OC_PKG.del_pol_deductibles(
		   			#{policyId},#{deductible.coverCd},#{deductible.endtCd},#{deductible.deductibleCd,jdbcType=VARCHAR}
		   		);
		    </foreach>
			<foreach collection="saveDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_OC_PKG.save_pol_deductibles(
		   			#{policyId},#{deductible.coverCd,jdbcType=VARCHAR},#{deductible.endtCd},#{deductible.deductibleCd},#{deductible.deductibleRt,jdbcType=VARCHAR},
		   			#{deductible.deductibleAmt,jdbcType=VARCHAR},#{deductible.deductibleTxt},#{deductible.createUser},
		   			CAST(to_timestamp(#{deductible.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{deductible.updateUser},
				   	CAST(to_timestamp(#{deductible.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE) 
		   		);
		   	</foreach>
		END;
	</update>
	
	<update id="savePolEndorsement" parameterType="java.util.Map">
		BEGIN
			<foreach collection="deleteEndorsements" item="endo">
				POL_ENDT_PKG.del_pol_endt(#{policyId},#{endo.endtCd});
			</foreach>
			<foreach collection="saveEndorsements" item="endo">
				POL_ENDT_PKG.save_pol_endt(
					#{policyId},#{endo.endtCd},#{endo.changeTag,jdbcType=VARCHAR},
					#{endo.remarks,jdbcType=VARCHAR},#{endo.createUser},
		   			CAST(to_timestamp(#{endo.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
		   			#{endo.updateUser},
				   	CAST(to_timestamp(#{endo.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				   	#{endo.endtText.endtText01, jdbcType=VARCHAR},	#{endo.endtText.endtText02, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText03, jdbcType=VARCHAR},	#{endo.endtText.endtText04, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText05, jdbcType=VARCHAR},	#{endo.endtText.endtText06, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText07, jdbcType=VARCHAR},	#{endo.endtText.endtText08, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText09, jdbcType=VARCHAR},	#{endo.endtText.endtText10, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText11, jdbcType=VARCHAR},	#{endo.endtText.endtText12, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText13, jdbcType=VARCHAR},	#{endo.endtText.endtText14, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText15, jdbcType=VARCHAR},	#{endo.endtText.endtText16, jdbcType=VARCHAR},	
				   	#{endo.endtText.endtText17, jdbcType=VARCHAR}
				);
			</foreach>
			<foreach collection="deleteDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.del_pol_deductibles(
		   			#{policyId},#{deductible.coverCd},#{deductible.endtCd},#{deductible.deductibleCd,jdbcType=VARCHAR}
		   		);
		    </foreach>
			<foreach collection="saveDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.save_pol_deductibles(
		   			#{policyId},#{deductible.coverCd,jdbcType=VARCHAR},#{deductible.endtCd},#{deductible.deductibleCd},#{deductible.deductibleRt,jdbcType=VARCHAR},
		   			#{deductible.deductibleAmt,jdbcType=VARCHAR},#{deductible.deductibleTxt},#{deductible.createUser},
		   			CAST(to_timestamp(#{deductible.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{deductible.updateUser},
				   	CAST(to_timestamp(#{deductible.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE) 
		   		);
		   	</foreach>
		END;
	</update>
	
	<update id="savePDGenInfo" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_gen_info(#{policyId, mode=OUT, jdbcType=INTEGER},
											  	   #{policyNo, mode=OUT, jdbcType=VARCHAR},
											  	   #{lineCd, jdbcType=VARCHAR},
											  	   #{quotationNo, jdbcType=VARCHAR},
											  	   #{holdCoverNo, jdbcType=VARCHAR},
												   #{openPolicyNo, jdbcType=VARCHAR},
												   #{optionId, jdbcType=INTEGER},
												   CAST(to_timestamp(#{inceptDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												   CAST(to_timestamp(#{expiryDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												   #{createUser, jdbcType=VARCHAR},
												   CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												   #{updateUser, jdbcType=VARCHAR},
												   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
												  );
		END;
	</update>
	
	<update id="savePDProject" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_project(#{policyId, jdbcType=INTEGER},
												  #{quotationNo, jdbcType=VARCHAR},
												  #{holdCoverNo, jdbcType=VARCHAR},
												  #{openPolicyNo, jdbcType=VARCHAR},
												  #{createUser, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{updateUser, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
											     );
		END;
	</update>
	
	<update id="savePDCoverage" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_coverage(#{policyId, jdbcType=INTEGER},
												   #{quotationNo, jdbcType=VARCHAR},
												   #{holdCoverNo, jdbcType=VARCHAR},
												   #{openPolicyNo, jdbcType=VARCHAR},
												   #{optionId, jdbcType=INTEGER},
												   #{createUser, jdbcType=VARCHAR},
												   CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												   #{updateUser, jdbcType=VARCHAR},
												   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
											      );
		END;
	</update>
	
	<update id="savePDSecCovers" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_sec_cover(#{policyId, jdbcType=INTEGER},
													#{quotationNo, jdbcType=VARCHAR},
													#{holdCoverNo, jdbcType=VARCHAR},
													#{openPolicyNo, jdbcType=VARCHAR},
													#{optionId, jdbcType=INTEGER},
													#{createUser, jdbcType=VARCHAR},
													CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
													#{updateUser, jdbcType=VARCHAR},
													CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
											   		);
		END;
	</update>	
	
	<update id="savePDDeductibles" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_deductibles(#{policyId, jdbcType=INTEGER},
											  		  #{quotationNo, jdbcType=VARCHAR},
											  		  #{holdCoverNo, jdbcType=VARCHAR},
											  		  #{openPolicyNo, jdbcType=VARCHAR},
											  		  #{optionId, jdbcType=INTEGER},
											  		  #{createUser, jdbcType=VARCHAR},
											  		  CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											  		  #{updateUser, jdbcType=VARCHAR},
											  		  CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
										     		  );
		END;
	</update>
	
	<update id="savePDAlop" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_alop(#{policyId, jdbcType=INTEGER},
											   #{quotationNo, jdbcType=VARCHAR},
											   #{holdCoverNo, jdbcType=VARCHAR},
											   #{openPolicyNo, jdbcType=VARCHAR},
											   #{optionId, jdbcType=INTEGER},
											   #{createUser, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
											   #{updateUser, jdbcType=VARCHAR},
											   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
										      );
		END;
	</update>
	
	<update id="savePDAlopItem" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_alop_item(#{policyId, jdbcType=INTEGER},
												    #{quotationNo, jdbcType=VARCHAR},
												    #{holdCoverNo, jdbcType=VARCHAR},
												    #{openPolicyNo, jdbcType=VARCHAR},
												    #{optionId, jdbcType=INTEGER},
												    #{createUser, jdbcType=VARCHAR},
												    CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												    #{updateUser, jdbcType=VARCHAR},
												    CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
											       );
		END;
	</update>
	
	<update id="savePDEndorsements" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_endorsements(#{policyId, jdbcType=INTEGER},
													   #{quotationNo, jdbcType=VARCHAR},
													   #{holdCoverNo, jdbcType=VARCHAR},
													   #{openPolicyNo, jdbcType=VARCHAR},
													   #{optionId, jdbcType=INTEGER},
													   #{createUser, jdbcType=VARCHAR},
													   CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
													   #{updateUser, jdbcType=VARCHAR},
													   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
												      );
		END;
	</update>
	
	<update id="savePDAttachments" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_attachments(#{policyId, jdbcType=INTEGER},
													  #{quotationNo, jdbcType=VARCHAR},
													  #{holdCoverNo, jdbcType=VARCHAR},
													  #{openPolicyNo, jdbcType=VARCHAR},
													  #{createUser, jdbcType=VARCHAR},
													  CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
													  #{updateUser, jdbcType=VARCHAR},
													  CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
												     );
		END;
	</update>
	
	<update id="savePDPolInwardBal" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_pol_inw(#{policyId, jdbcType=INTEGER},											  
												  #{createUser, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												  #{updateUser, jdbcType=VARCHAR},
												  CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
												 );
		END;
	</update>
	
	<update id="saveSumInsOC" parameterType="java.util.Map">
		BEGIN
			POL_COVERAGE_OC_PKG.save_sum_ins_oc(#{policyId},#{pctShare},#{pctPml},#{totalValue},#{updateUser, jdbcType=VARCHAR},
											  CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
		END;
	</update>
	
	<select id="retrievePolicyOcListing" parameterType="java.util.Map" resultMap="PolicyOcListingMap">
		SELECT * FROM TABLE(POL_GEN_INFO_OC_PKG.ret_pol_list_oc(#{policyNo, jdbcType=VARCHAR},
															 #{cessionDesc, jdbcType=VARCHAR},
															 #{cedingName, jdbcType=VARCHAR},
															 #{lineClassDesc, jdbcType=VARCHAR},
															 #{insuredDesc, jdbcType=VARCHAR},
															 #{riskName, jdbcType=VARCHAR},
															 #{objectDesc, jdbcType=VARCHAR},
															 #{site, jdbcType=VARCHAR},
															 #{currencyCd, jdbcType=VARCHAR},
															 #{totalSiLess, jdbcType=DECIMAL},
															 #{totalSiGrt, jdbcType=DECIMAL},
															 #{totalPremLess, jdbcType=DECIMAL},
															 #{totalPremGrt, jdbcType=DECIMAL},
															 CAST(to_timestamp(#{issueDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{issueDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{inceptDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{inceptDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{expiryDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{expiryDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{acctDateFrom, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 CAST(to_timestamp(#{acctDateTo, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
															 #{statusDesc, jdbcType=VARCHAR},
															 null,
															 null,
															 null,
															 null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.PolicyOc" id="PolicyOcListingMap">
		<result property="policyIdOc"           column="POLICY_ID_OC"/>
        <result property="openPolicyNo"         column="POLICY_NO"/>
        <result property="cessionDesc"          column="CESSION_DESC"/>
        <result property="cedingId"             column="CEDING_ID"/>
        <result property="cedingName"           column="CEDING_NAME"/>
        <result property="lineClassDesc"        column="LINE_CLASS_DESC"/>
        <result property="insuredDesc"          column="INSURED_DESC"/>
        <result property="currencyCd"           column="CURRENCY_CD"/>
        <result property="issueDate"            column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="expiryDate"           column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
        <result property="inceptDate"           column="INCEPT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
        <result property="acctDate"             column="ACCT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
        <result property="statusDesc"           column="STATUS_DESC"/>
        <result property="optionId"             column="OPTION_ID"/>
        <result property="condition"            column="CONDITION"/>
        <result property="optionRt"             column="OPTION_RT"/>
        <association property="project" resultMap="PolProjOcListingMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ProjectOc" id="PolProjOcListingMap">
		<result property="riskName"           	column="RISK_NAME"/>
        <result property="objectDesc"           column="OBJECT_DESC"/>
        <result property="site"           		column="SITE"/>
        <association property="coverageOc" resultMap="PolCovOcListingMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.CoverageOc" id="PolCovOcListingMap">
		<result property="totalSi"          column="TOTAL_SI"/>
        <result property="totalPrem"           column="TOTAL_PREM"/>
	</resultMap>

	<update id="updatePolHoldCoverStatus" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POL_HOLD_COVER_PKG.upd_hc_status(#{policyId, jdbcType=INTEGER},
											 #{holdCovId, jdbcType=INTEGER},
											 #{updateType, jdbcType=VARCHAR},
											 #{updateUser, jdbcType=VARCHAR},
											 CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
											 );
		END;
	</update>
	
	<update id="saveOpenPolDetails" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			CONVERT_QU_TO_OPENPOL_PKG.save_opd(#{policyIdOc, mode=OUT, jdbcType=INTEGER},
										 #{openPolNo, mode=OUT, jdbcType=VARCHAR},
										 #{quotationNo, jdbcType=VARCHAR},
										 #{optionId, jdbcType=INTEGER},
										 CAST(to_timestamp(#{inceptDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
										 CAST(to_timestamp(#{expiryDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
										 #{createUser, jdbcType=VARCHAR},
										 CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
										 #{updateUser, jdbcType=VARCHAR},
										 CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
										);
		END;
	</update>
	

	<resultMap type="ph.cpi.rest.api.model.workflowmanager.Approval" id="wfmApprovalsMap">
		<result property="referenceId"		column="REFERENCE_ID" />		
		<result property="module"			column="MODULE" />			
		<result property="quotationNo"		column="QUOTATION_NO" />		
		<result property="preparedBy"		column="PREPARED_BY" />		
		<result property="createDate"		column="CREATE_DATE" />
	
	</resultMap>
	
	<select id="retrieveWfmApprovals" parameterType="java.util.Map" resultMap="wfmApprovalsMap">
		SELECT a.quote_id REFERENCE_ID, 'Quotation' MODULE, get_quote_no(a.quote_id) QUOTATION_NO, a.PREPARED_BY, a.CREATE_DATE  FROM QUOTE_GEN_INFO a
		 WHERE a.status = 'P'
		   AND a.approved_by = #{userId, jdbcType=VARCHAR}
	</select>

	<select id="retrievePolCoverageAlt" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_COVERAGE_ALT_PKG.ret_pol_cover_alt(#{lineCd},#{polYear},#{seqNo},#{cedingId},#{coSeriesNo},#{altNo},
																	   #{position, jdbcType=VARCHAR}, 
																	   #{count, jdbcType=VARCHAR}, 
																	   #{sortKey, jdbcType=VARCHAR}, 
																	   #{order, jdbcType=VARCHAR}))
	</select>
	
	
	<update id="savePolAttachmentOC" parameterType="java.util.Map">
		BEGIN
		   <foreach collection="savePolAttachments" item="attachment">
		   	   POL_ATTACHMENT_OC_PKG.save_pol_attchmnt_oc(#{policyId},
		   	   										#{attachment.fileNo, jdbcType=VARCHAR},
		   	   										#{attachment.fileName},
		   	   										#{attachment.description, jdbcType=VARCHAR},
		   	   										#{attachment.createUser},
			   										CAST(to_timestamp(#{attachment.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
			   										#{attachment.updateUser},
			   										CAST(to_timestamp(#{attachment.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
		   </foreach>
		   <foreach collection="deletePolAttachments" item="attachment">
		   		POL_ATTACHMENT_OC_PKG.del_pol_attchmnt_oc(#{policyId},
		   											#{attachment.fileNo, jdbcType=VARCHAR});
		   </foreach>
		END;
	</update>
	
	<select id="retrievePolHoldCoverListing" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_HOLD_COVER_PKG.ret_pol_hc_list(
			#{holdCovNo,jdbcType=VARCHAR},
			#{status,jdbcType=VARCHAR},
			#{cedingName,jdbcType=VARCHAR},
			#{policyNo,jdbcType=VARCHAR},
			#{riskName,jdbcType=VARCHAR},
			#{insuredName,jdbcType=VARCHAR},
			#{periodFrom,jdbcType=DATE},
			#{periodTo,jdbcType=DATE},
			#{compRefHoldCovNo,jdbcType=VARCHAR},
			#{reqBy,jdbcType=VARCHAR},
			#{reqDateFrom,jdbcType=DATE},
			#{reqDateTo,jdbcType=DATE},
			#{expiringInDays,jdbcType=INTEGER},
			'',
			'',
			'',
			''
		))
	</select>

	<resultMap type="ph.cpi.rest.api.model.underwriting.PolicyOc" id="polGenInfoOcMap">
		<result property="policyIdOc" 		column="POLICY_ID_OC" />
		<result property="openPolicyNo" 	column="OPEN_POLICY_NO" />
		<result property="lineCd" 			column="LINE_CD" />
		<result property="lineCdDesc" 		column="LINE_CD_DESC" />
		<result property="ocYear" 			column="OC_YEAR" />
		<result property="ocSeqNo" 			column="OC_SEQ_NO" />
		<result property="cedingId" 		column="CEDING_ID" />
		<result property="cedingName" 		column="CEDING_NAME" />
		<result property="coSeriesNo" 		column="CO_SERIES_NO" />
		<result property="altNo" 			column="ALT_NO" />
		<result property="cessionId" 		column="CESSION_ID" />
		<result property="cessionDesc" 		column="CESSION_DESC" />
		<result property="lineClassCd" 		column="LINE_CLASS_CD" />
		<result property="quoteId" 			column="QUOTE_ID" />
		<result property="quoteNo" 			column="QUOTE_NO" />
		<result property="lineClassDesc" 	column="LINE_CLASS_DESC" />
		<result property="refOpPolNo" 		column="REF_OP_POL_NO" />
		<result property="prinId" 			column="PRIN_ID" />
		<result property="prinName" 		column="PRIN_NAME" />
		<result property="contractorId" 	column="CONTRACTOR_ID" />
		<result property="contractorName" 	column="CONTRACTOR_NAME" />
		<result property="insuredDesc" 		column="INSURED_DESC" />
		<result property="status" 			column="STATUS" />
		<result property="statusDesc" 		column="STATUS_DESC" />
		<result property="reinsurerId" 		column="REINSURER_ID" />
		<result property="reinsurerName"    column="REINSURER_NAME" />
		<result property="intmId" 			column="INTM_ID" />
		<result property="intmName" 		column="INTM_NAME" />
		<result property="inceptDate" 		column="INCEPT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="expiryDate" 		column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="lapseFrom" 		column="LAPSE_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="lapseTo" 			column="LAPSE_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="issueDate" 		column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="effDate" 			column="EFF_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="distDate" 		column="DIST_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="acctDate" 		column="ACCT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="currencyCd" 		column="CURRENCY_CD" />
		<result property="currencyRt" 		column="CURRENCY_RT" />
		<result property="coRefNo" 			column="CO_REF_NO" />
		<result property="riBinderNo" 		column="RI_BINDER_NO" />
		<result property="createUser" 		column="CREATE_USER" />
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser" 		column="UPDATE_USER" />
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<association property="project"		resultMap="assocProjOcMap" />
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ProjectOc" id="assocProjOcMap">
		<result property="projId"				column="PROJ_ID" />
		<result property="projDesc"				column="PROJ_DESC" />
		<result property="riskId"				column="RISK_ID" />
		<result property="riskName"				column="RISK_NAME" />
		<result property="regionCd"				column="REGION_CD" />
		<result property="regionDesc"			column="REGION_DESC" />
		<result property="provinceCd"			column="PROVINCE_CD" />
		<result property="provinceDesc"			column="PROVINCE_DESC" />
		<result property="cityCd"				column="CITY_CD" />
		<result property="cityDesc"				column="CITY_DESC" />
		<result property="districtCd"			column="DISTRICT_CD" />
		<result property="districtDesc"			column="DISTRICT_DESC" />
		<result property="blockCd"				column="BLOCK_CD" />
		<result property="blockDesc"			column="BLOCK_DESC" />
		<result property="latitude"				column="LATITUDE" />
		<result property="longitude"			column="LONGITUDE" />
		<result property="totalSi"				column="TOTAL_SI" />
		<result property="objectId"				column="OBJECT_ID" />
		<result property="objectDesc"			column="OBJ_DESC" />
		<result property="site"					column="SITE" />
		<result property="duration"				column="DURATION" />
		<result property="testing"				column="TESTING" />
		<result property="prCreateUser"			column="PR_CREATE_USER" />
		<result property="prCreateDate"			column="PR_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="prUpdateUser"			column="PR_UPDATE_USER" />
		<result property="prUpdateDate"			column="PR_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<select id="retrievePolGenInfoOc" parameterType="java.util.Map" resultMap="polGenInfoOcMap">
		SELECT * FROM TABLE(POL_GEN_INFO_OC_PKG.ret_pol_gi_oc(
																#{policyIdOc, jdbcType=INTEGER},
																#{openPolicyNo, jdbcType=VARCHAR},
																#{position, jdbcType=VARCHAR}, 
																#{count, jdbcType=VARCHAR}, 
																#{sortKey, jdbcType=VARCHAR}, 
																#{order, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveAlterationsPerPolicy" parameterType="java.util.Map" resultMap="policyMap">		
		SELECT * FROM TABLE(POL_GEN_INFO_PKG.ret_alt_listing(#{policyId, jdbcType=INTEGER},
															 #{position, jdbcType=VARCHAR}, 
															 #{count, jdbcType=INTEGER}, 
															 #{sortKey, jdbcType=VARCHAR}, 
															 #{order, jdbcType=VARCHAR}))		
	</select>

	<update id="savePolGenInfoOc" parameterType="java.util.Map">
		BEGIN
			POL_GEN_INFO_OC_PKG.save_pol_gen_info_oc(
				#{policyIdOc},#{lineCd},#{ocYear},#{ocSeqNo},#{cedingId},#{coSeriesNo},#{riBinderNo, jdbcType=VARCHAR},
				#{coRefNo, jdbcType=VARCHAR},#{altNo},#{cessionId},#{lineClassCd},#{quoteId},#{refOpPolNo, jdbcType=VARCHAR},#{prinId},#{contractorId},
				#{insuredDesc},#{status},#{reinsurerId, jdbcType=VARCHAR},#{intmId, jdbcType=VARCHAR},
				CAST(to_timestamp(#{inceptDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{expiryDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{lapseFrom}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{lapseTo}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{issueDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{effDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{distDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
				CAST(to_timestamp(#{acctDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{currencyCd},#{currencyRt},
				#{createUser},CAST(to_timestamp(#{createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{updateUser},
				CAST(to_timestamp(#{updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{projId},#{projDesc},
				#{riskId},#{maxSi},#{objectId},#{site},#{duration, jdbcType=VARCHAR},#{testing, jdbcType=VARCHAR},
				#{regionCd},#{provinceCd},#{cityCd},#{districtCd, jdbcType=VARCHAR},#{blockCd, jdbcType=VARCHAR},
				#{latitude, jdbcType=VARCHAR},#{longitude, jdbcType=VARCHAR},#{projCreateUser},
				CAST(to_timestamp(#{projCreateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{projUpdateUser},
				CAST(to_timestamp(#{projUpdateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
			);
		END;
	</update>
	
	<update id="retrieveAlterationsPerCoIns" parameterType="java.util.Map" statementType="CALLABLE">
		{CALL
			#{coInsAlt, mode=OUT, javaType=Integer, jdbcType=INTEGER} := POL_GEN_INFO_PKG.ret_coins_alt(#{policyId, jdbcType=INTEGER},
																						  				#{position, jdbcType=VARCHAR}, 
																						  				#{count, jdbcType=INTEGER}, 
																										#{sortKey, jdbcType=VARCHAR}, 
																										#{order, jdbcType=VARCHAR})
		}	
	</update>
	
	<update id="updatePolGenInfoSpoilage" parameterType="java.util.Map">
		BEGIN
			MTN_SPOIL_PKG.up_pol_gen_info(#{policyId, jdbcType=INTEGER},
										  #{status, jdbcType=VARCHAR},
										  #{spoilCd, jdbcType=VARCHAR},
										  #{spldUser, jdbcType=VARCHAR},
										  #{updateUser, jdbcType=VARCHAR}
										  );
		END;
	</update>
	
	<update id="retrieveCoInsStatus" parameterType="java.util.Map" statementType="CALLABLE">
		{CALL
			#{coInsStatus, mode=OUT, javaType=Integer, jdbcType=INTEGER} := CONVERT_QU_TO_POL_PKG.ret_coins_status(#{checkingType, jdbcType=VARCHAR},
																												   #{policyId, jdbcType=INTEGER},	
																												   #{quotationNo, jdbcType=VARCHAR},
																									  			   #{position, jdbcType=VARCHAR}, 
																									  			   #{count, jdbcType=INTEGER}, 
																												   #{sortKey, jdbcType=VARCHAR}, 
																												   #{order, jdbcType=VARCHAR})
		}	
	</update>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.EndtText" id="EndtTextMapper">
		<result property="endtText01" column="ENDT_TEXT01"/>
		<result property="endtText02" column="ENDT_TEXT02"/>
		<result property="endtText03" column="ENDT_TEXT03"/>
		<result property="endtText04" column="ENDT_TEXT04"/>
		<result property="endtText05" column="ENDT_TEXT05"/>
		<result property="endtText06" column="ENDT_TEXT06"/>
		<result property="endtText07" column="ENDT_TEXT07"/>
		<result property="endtText08" column="ENDT_TEXT08"/>
		<result property="endtText09" column="ENDT_TEXT09"/>
		<result property="endtText10" column="ENDT_TEXT10"/>
		<result property="endtText11" column="ENDT_TEXT11"/>
		<result property="endtText12" column="ENDT_TEXT12"/>
		<result property="endtText13" column="ENDT_TEXT13"/>
		<result property="endtText14" column="ENDT_TEXT14"/>
		<result property="endtText15" column="ENDT_TEXT15"/>
		<result property="endtText16" column="ENDT_TEXT16"/>
		<result property="endtText17" column="ENDT_TEXT17"/>
		<result property="createUser" column="F_CREATE_USER"/>
		<result property="createDate" column="F_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" column="F_UPDATE_USER"/>
		<result property="updateDate" column="F_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>

	<update id="updatePolGenInfo" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			POL_GEN_INFO_PKG.update_gen_info(#{policyId, jdbcType=INTEGER},
											 #{riskId, jdbcType=INTEGER},
											 #{coRefNo, jdbcType=VARCHAR},
											 #{riBinderNo, jdbcType=VARCHAR},
											 #{intmId, jdbcType=VARCHAR},
											 #{projDesc, jdbcType=VARCHAR},
											 #{latitude, jdbcType=VARCHAR},
											 #{longtitude, jdbcType=VARCHAR},
											 #{updateUser, jdbcType=VARCHAR},
											 CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
											 );
		END;
	</update>
	
	<update id="savePDWordings" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_wordings(#{policyId, jdbcType=INTEGER},											  
												   #{createUser, jdbcType=VARCHAR},
												   CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												   #{updateUser, jdbcType=VARCHAR},
												   CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
												  );
		END;
	</update>
	
	<update id="savePDCatPeril" parameterType="java.util.Map">
		BEGIN
			CONVERT_QU_TO_POL_PKG.save_pd_cat_peril(#{policyId, jdbcType=INTEGER},											  
												    #{createUser, jdbcType=VARCHAR},
												    CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
												    #{updateUser, jdbcType=VARCHAR},
												    CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
												   );
		END;
	</update>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.PolWordings" id="PolWordingsMap">
		<result property="wordingCd" column="WORDING_CD"/>
		<result property="polwText01" column="POLW_TEXT01"/>
		<result property="polwText02" column="POLW_TEXT02"/>
		<result property="polwText03" column="POLW_TEXT03"/>
		<result property="polwText04" column="POLW_TEXT04"/>
		<result property="polwText05" column="POLW_TEXT05"/>
		<result property="polwText06" column="POLW_TEXT06"/>
		<result property="polwText07" column="POLW_TEXT07"/>
		<result property="polwText08" column="POLW_TEXT08"/>
		<result property="polwText09" column="POLW_TEXT09"/>
		<result property="polwText10" column="POLW_TEXT10"/>
		<result property="polwText11" column="POLW_TEXT11"/>
		<result property="polwText12" column="POLW_TEXT12"/>
		<result property="polwText13" column="POLW_TEXT13"/>
		<result property="polwText14" column="POLW_TEXT14"/>
		<result property="polwText15" column="POLW_TEXT15"/>
		<result property="polwText16" column="POLW_TEXT16"/>
		<result property="polwText17" column="POLW_TEXT17"/>
		<result property="altwText01" column="ALTW_TEXT01"/>
		<result property="altwText02" column="ALTW_TEXT02"/>
		<result property="altwText03" column="ALTW_TEXT03"/>
		<result property="altwText04" column="ALTW_TEXT04"/>
		<result property="altwText05" column="ALTW_TEXT05"/>
		<result property="altwText06" column="ALTW_TEXT06"/>
		<result property="altwText07" column="ALTW_TEXT07"/>
		<result property="altwText08" column="ALTW_TEXT08"/>
		<result property="altwText09" column="ALTW_TEXT09"/>
		<result property="altwText10" column="ALTW_TEXT10"/>
		<result property="altwText11" column="ALTW_TEXT11"/>
		<result property="altwText12" column="ALTW_TEXT12"/>
		<result property="altwText13" column="ALTW_TEXT13"/>
		<result property="altwText14" column="ALTW_TEXT14"/>
		<result property="altwText15" column="ALTW_TEXT15"/>
		<result property="altwText16" column="ALTW_TEXT16"/>
		<result property="altwText17" column="ALTW_TEXT17"/>
		<result property="createUser" column="POLW_CREATE_USER"/>
		<result property="createDate" column="POLW_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" column="POLW_UPDATE_USER"/>
		<result property="updateDate" column="POLW_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<update id="postPolicy" parameterType="java.util.Map">
		BEGIN
			POL_GEN_INFO_PKG.post(#{policyId},#{updateUser});
			DIST_PKG.dist_policy(#{policyId},#{updateUser},sysdate,#{updateUser},sysdate);
		END;
	</update>
	
	<update id="genHundredValPolPrinting" parameterType="java.util.Map">
		BEGIN
			GEN_POL_PRINT_PKG.to_full_cov(
											#{policyId},
											#{projId},
											#{riskId},
											#{treatyShare},
											#{createUser, jdbcType=VARCHAR},
										    CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
										    #{updateUser, jdbcType=VARCHAR},
										    CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
										  );
		    GEN_POL_PRINT_PKG.to_full_sec(
		    								#{policyId},
											#{projId},
											#{riskId},
											#{lineCd},
											#{treatyShare},
											#{createUser, jdbcType=VARCHAR},
										    CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
										    #{updateUser, jdbcType=VARCHAR},
										    CAST(to_timestamp(#{updateDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE)
		    							 );
		    GEN_POL_PRINT_PKG.update_full_cov(
		    									#{policyId},
		    									#{treatyShare}
		    								  );
	     END;
	</update>

	<resultMap type="ph.cpi.rest.api.model.underwriting.FullCoverage" id="fullCoverageMap">
		<result property="treatyShare" 			column="TREATY_SHARE"/>
		<result property="sectionISi" 			column="SECTION_I_SI"/>
		<result property="sectionIISi" 			column="SECTION_II_SI"/>
		<result property="sectionIIISi" 		column="SECTION_III_SI"/>
		<result property="totalSi" 				column="TOTAL_SI"/>
		<result property="sectionIPrem" 		column="SECTION_I_PREM"/>
		<result property="sectionIIPrem" 		column="SECTION_II_PREM"/>
		<result property="sectionIIIPrem" 		column="SECTION_III_PREM"/>
		<result property="totalPrem" 			column="TOTAL_PREM"/>
		<result property="currencyCd" 			column="CURRENCY_CD"/>
		<result property="currencyRt" 			column="CURRENCY_RT"/>
		<result property="pctShare" 			column="PCT_SHARE"/>
		<result property="pctPml" 				column="PCT_PML"/>
		<result property="totalValue" 			column="TOTAL_VALUE"/>
		<result property="remarks" 				column="REMARKS"/>
		<result property="cumSecISi" 			column="CUM_SECI_SI"/>
		<result property="cumSecIISi" 			column="CUM_SECII_SI"/>
		<result property="cumSecIIISi" 			column="CUM_SECIII_SI"/>
		<result property="cumTSi" 				column="CUM_TSI"/>
		<result property="cumSecIPrem" 			column="CUM_SECI_PREM"/>
		<result property="cumSecIIPrem" 		column="CUM_SECII_PREM"/>
		<result property="cumSecIIIPrem" 		column="CUM_SECIII_PREM"/>
		<result property="cumTPrem" 			column="CUM_TPREM"/>
		<result property="createUser" 			column="CREATE_USER"/>
		<result property="createDate" 			column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUser" 			column="UPDATE_USER"/>
		<result property="updateDate" 			column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="fullSecCover" resultMap ="fullSecCoverMap"></association>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.FullSecCover" id="fullSecCoverMap">
		<result property="lineCd" 					column="LINE_CD"/>
		<result property="lineCdDesc" 				column="LINE_DESC"/>
		<result property="section" 					column="SECTION"/>
		<result property="coverCd" 					column="COVER_CD"/>
		<result property="coverName" 				column="COVER_NAME"/>
		<result property="bulletNo" 				column="BULLET_NO"/>
		<result property="orgSumInsured" 			column="ORIG_SUM_INSURED"/>
		<result property="orgPremRt" 				column="ORIG_PREM_RT"/>
		<result property="orgPremAmt" 				column="ORIG_PREM_AMT"/>
		<result property="sumInsured" 				column="SUM_INSURED"/>
		<result property="premRt" 					column="PREM_RT"/>
		<result property="premAmt" 					column="PREM_AMT"/>
		<result property="addSi" 					column="ADD_SI"/>
		<result property="discountTag" 				column="DISCOUNT_TAG"/>
		<result property="cumSi" 					column="CUM_SI"/>
		<result property="cumPrem" 					column="CUM_PREM"/>	
		<result property="createUserSec" 			column="CREATE_USER_SEC"/>
		<result property="createDateSec" 			column="CREATE_DATE_SEC" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<result property="updateUserSec" 			column="UPDATE_USER_SEC"/>
		<result property="updateDateSec" 			column="UPDATE_DATE_SEC" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		<association property="deductiblesSec" resultMap="DeductibleMap"></association>
	</resultMap>
	
	<select id="retrievePolFullCoverage" resultMap="policyMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(POL_FULLCOVERAGE_PKG.ret_pol_cover_value(#{policyId, jdbcType=VARCHAR},#{policyNo, jdbcType=VARCHAR},#{position, jdbcType=VARCHAR}, 
																	   #{count, jdbcType=VARCHAR}, 
																	   #{sortKey, jdbcType=VARCHAR}, 
																	   #{order, jdbcType=VARCHAR}))
	</select>
	
	<update id="savePolFullCoverage" parameterType="java.util.Map">
		BEGIN
			POL_FULLCOVERAGE_PKG.save_pol_cover_value( #{policyId},#{projId},#{riskId},#{treatyShare},#{sectionISi}, #{sectionIISi}, #{sectionIIISi}, #{totalSi},
										   #{sectionIPrem}, #{sectionIIPrem}, #{sectionIIIPrem}, 
										   #{totalPrem}, #{currencyCd}, #{currencyRt}, #{pctShare}, 
										   #{pctPml, jdbcType=VARCHAR}, #{totalValue}, #{remarks, jdbcType=VARCHAR}, #{cumSecISi}, #{cumSecIISi}, #{cumSecIIISi}, #{cumTSi}, 
										   #{cumSecIPrem}, #{cumSecIIPrem}, #{cumSecIIIPrem}, #{cumTPrem},  #{createUser,jdbcType=VARCHAR}, 
										    CAST(to_timestamp(#{createDate, jdbcType=VARCHAR}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), 
										    #{updateUser},  CAST(to_timestamp(#{updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			
			<foreach collection="deleteFullSectionCovers" item="sectioncovers">
				POL_FULLCOVERAGE_PKG.del_pol_cover_value(#{policyId},#{projId},#{riskId},#{sectioncovers.lineCd}, 
													#{sectioncovers.section}  ,#{sectioncovers.coverCd});
			</foreach>
			
			<foreach collection="saveFullSectionCovers" item="sectioncovers">
				POL_FULLCOVERAGE_PKG.save_pol_sec_cvrs_value(#{policyId},#{projId},#{riskId},#{sectioncovers.lineCd}, 
													#{sectioncovers.section}  ,#{sectioncovers.coverCd} , #{sectioncovers.coverName},
													#{sectioncovers.bulletNo},#{sectioncovers.sumInsured},
													#{sectioncovers.premRt},#{sectioncovers.premAmt},
													#{sectioncovers.addSi}, #{sectioncovers.discountTag, jdbcType=VARCHAR}, 
													#{sectioncovers.cumSi}, #{sectioncovers.cumPrem}, 
													#{sectioncovers.createUserSec},
													CAST(to_timestamp(#{sectioncovers.createDateSec}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),
													#{sectioncovers.updateUserSec}, CAST(to_timestamp(#{sectioncovers.createDateSec}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE));
			</foreach>
			
			<foreach collection="deleteDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.del_pol_deductibles(
		   			#{policyId},#{deductible.coverCd},#{deductible.endtCd},#{deductible.deductibleCd,jdbcType=VARCHAR}
		   		);
		    </foreach>
		    
			<foreach collection="saveDeductibleList" item="deductible">
		   		POL_DEDUCTIBLES_PKG.save_pol_deductibles(
		   			#{policyId},#{deductible.coverCd,jdbcType=VARCHAR},#{deductible.endtCd},#{deductible.deductibleCd},#{deductible.deductibleRt,jdbcType=VARCHAR},
		   			#{deductible.deductibleAmt,jdbcType=VARCHAR},#{deductible.deductibleTxt},#{deductible.createUser},
		   			CAST(to_timestamp(#{deductible.createDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE),#{deductible.updateUser},
				   	CAST(to_timestamp(#{deductible.updateDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE) 
		   		);
		   	</foreach>
		END;
	</update>
	
	
	<!-- 
			eepParams.put("policyId", eepr.getPolicyId()); 
			eepParams.put("policyNo", eepr.getPolicyNo()); 
			eepParams.put("fromExpiryDate", eepr.getFromExpiryDate()); 
			eepParams.put("toExpiryDate", eepr.getToExpiryDate()); 
			eepParams.put("lineCd", eepr.getLineCd()); 
			eepParams.put("cessionType", eepr.getCessionType()); 
			eepParams.put("cedingId", eepr.getCedingId());
			eepParams.put("extractUser", eepr.getExtractUser());
			eepParams.put("recordCount", 0); 
			 -->
			
	<update id="extractExpiringPolicy" parameterType="java.util.Map" statementType="CALLABLE">
		BEGIN
			DIST_EXT_PKG.extract_exp_policy(#{policyId}, 
											#{policyNo}, 
											CAST(to_timestamp(#{fromExpiryDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), 
											CAST(to_timestamp(#{toExpiryDate}, 'YYYY-MM-DD"T"HH24:MI:SS') AS DATE), 
											#{lineCd}, 
											#{cessionType}, 
											#{cedingId}, 
											#{extractUser},
											#{recordCount, mode=OUT, jdbcType=INTEGER}
										   );
		END;
	</update>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpPolicy" id="retrieveExpPolListMap">
		<result property="policyId"				column="POLICY_ID" /> 
		<result property="policyNo"				column="POLICY_NO" /> 
		<result property="extractUser"			column="EXTRACT_USER" /> 
		<result property="extractDate"			column="EXTRACT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
		<result property="processTag"			column="PROCESS_TAG" /> 
		<result property="processedBy"			column="PROCESSED_BY" /> 
		<result property="processedDate"		column="PROCESSED_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="renewalFlag"			column="RENEWAL_FLAG" /> 
		<result property="summaryTag"			column="SUMMARY_TAG" /> 
		<result property="balanceTag"			column="BALANCE_TAG" /> 
		<result property="claimTag"				column="CLAIM_TAG" /> 
		<result property="reminderTag"			column="REMINDER_TAG" /> 
		<result property="nrReasonCd"			column="NR_REASON_CD" /> 
		<result property="cessionId"			column="CESSION_ID" /> 
		<result property="cessionDesc"			column="CESSION_DESC" /> 
		<result property="cedingId"				column="CEDING_ID" /> 
		<result property="cedingName"			column="CEDING_NAME" /> 
		<result property="lineClassCd"			column="LINE_CLASS_CD" /> 
		<result property="quoteId"				column="QUOTE_ID" /> 
		<result property="optionId"				column="OPTION_ID" /> 
		<result property="coRefNo"				column="CO_REF_NO" /> 
		<result property="reinsurerId"			column="REINSURER_ID" /> 
		<result property="riBinderNo"			column="RI_BINDER_NO" /> 
		<result property="mbiRefNo"				column="MBI_REF_NO" /> 
		<result property="intmId"				column="INTM_ID" /> 
		<result property="prinId"				column="PRIN_ID" /> 
		<result property="contractorId"			column="CONTRACTOR_ID" /> 
		<result property="insuredDesc"			column="INSURED_DESC" /> 
		<result property="inceptDate"			column="INCEPT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="expiryDate"			column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="lapseFrom"			column="LAPSE_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="lapseTo"				column="LAPSE_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="maintenanceFrom"		column="MAINTENANCE_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="maintenanceTo"		column="MAINTENANCE_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="issueDate"			column="ISSUE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="effDate"				column="EFF_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="distDate"				column="DIST_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="acctDate"				column="ACCT_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="currencyCd"			column="CURRENCY_CD" /> 
		<result property="currencyRt"			column="CURRENCY_RT" /> 
		<result property="bookedTag"			column="BOOKED_TAG" /> 
		<result property="govtTag"				column="GOVT_TAG" /> 
		<result property="openCoverTag"			column="OPEN_COVER_TAG" /> 
		<result property="holdCoverTag"			column="HOLD_COVER_TAG" /> 
		<result property="declarationTag"		column="DECLARATION_TAG" /> 
		<result property="minDepTag"			column="MIN_DEP_TAG" /> 
		<result property="altTag"				column="ALT_TAG" /> 
		<result property="specialPolicyTag"		column="SPECIAL_POLICY_TAG" /> 
		<result property="instTag"				column="INST_TAG" /> 
		<result property="extensionTag"			column="EXTENSION_TAG" /> 
		<result property="excludeDistTag"		column="EXCLUDE_DIST_TAG" />
		
		<collection property="projectList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expProjectMap" select="retrieveExpProject"/> 
		<collection property="itemList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expItemMap" select="retrieveExpItem"/> 
		<collection property="deductiblesList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expDeductiblesMap" select="retrieveExpDeductibles"/> 
		<collection property="sectionCoverList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expSectionCoverMap" select="retrieveExpSectionCover"/> 
		<collection property="coverageList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expCoverageMap" select="retrieveExpCoverage"/> 
		<collection property="catPerilList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expCatPerilMap" select="retrieveExpCatPeril"/> 
		<collection property="endorsementList" javaType="ArrayList" column="{policyId = POLICY_ID}" ofType="expEndorsementMap" select="retrieveExpEndorsement"/> 
		
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpProject" id="expProjectMap">
		<result property="policyId"			column="POLICY_ID" /> 
		<result property="projId"			column="PROJ_ID" /> 
		<result property="projDesc"			column="PROJ_DESC" /> 
		<result property="riskId"			column="RISK_ID" /> 
		<result property="regionCd"			column="REGION_CD" /> 
		<result property="provinceCd"		column="PROVINCE_CD" /> 
		<result property="cityCd"			column="CITY_CD" /> 
		<result property="districtCd"		column="DISTRICT_CD" /> 
		<result property="blockCd"			column="BLOCK_CD" /> 
		<result property="latitude"			column="LATITUDE" /> 
		<result property="longitude"		column="LONGITUDE" /> 
		<result property="objectId"			column="OBJECT_ID" /> 
		<result property="site"				column="SITE" /> 
		<result property="duration"			column="DURATION" /> 
		<result property="testing"			column="TESTING" /> 
		<result property="ipl"				column="IPL" /> 
		<result property="timeExc"			column="TIME_EXC" /> 
		<result property="noClaimPd"		column="NO_CLAIM_PD" /> 
		<result property="createUser"		column="CREATE_USER" /> 
		<result property="createDate"		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser"		column="UPDATE_USER" /> 
		<result property="updateDate"		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpItem" id="expItemMap">
		<result property="policyId"			column="POLICY_ID" /> 
		<result property="projId"			column="PROJ_ID" /> 
		<result property="itemNo"			column="ITEM_NO" /> 
		<result property="quantity"			column="QUANTITY" /> 
		<result property="itemDesc"			column="ITEM_DESC" /> 
		<result property="makeYear"			column="MAKE_YEAR" /> 
		<result property="deductibleTxt"	column="DEDUCTIBLE_TXT" /> 
		<result property="sumInsured"		column="SUM_INSURED" /> 
		<result property="stockType"		column="STOCK_TYPE" /> 
		<result property="serialNo"			column="SERIAL_NO" /> 
		<result property="location"			column="LOCATION" /> 
		<result property="chamberNo"		column="CHAMBER_NO" /> 
		<result property="noClaimPd"		column="NO_CLAIM_PD" /> 
		<result property="ipl"				column="IPL" /> 
		<result property="relativeImp"		column="RELATIVE_IMP" /> 
		<result property="standbyUnit"		column="STANDBY_UNIT" /> 
		<result property="createUser"		column="CREATE_USER" /> 
		<result property="createDate"		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
		<result property="updateUser"		column="UPDATE_USER" /> 
		<result property="updateDate"		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/> 
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpDeductibles" id="expDeductiblesMap">
		<result property="policyId"			column="POLICY_ID" /> 
		<result property="coverCd"			column="COVER_CD" /> 
		<result property="endtCd"			column="ENDT_CD" /> 
		<result property="deductibleCd"		column="DEDUCTIBLE_CD" /> 
		<result property="deductibleRt"		column="DEDUCTIBLE_RT" /> 
		<result property="deductibleAmt"	column="DEDUCTIBLE_AMT" /> 
		<result property="deductibleTxt"	column="DEDUCTIBLE_TXT" /> 
		<result property="deductibleTitle"	column="DEDUCTIBLE_TITLE" /> 
		<result property="createUser"		column="CREATE_USER" /> 
		<result property="createDate"		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
		<result property="updateUser"		column="UPDATE_USER" /> 
		<result property="updateDate"		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpSectionCover" id="expSectionCoverMap">
		<result property="policyId"		column="POLICY_ID" /> 
		<result property="lineCd"		column="LINE_CD" /> 
		<result property="projId"		column="PROJ_ID" /> 
		<result property="riskId"		column="RISK_ID" /> 
		<result property="section"		column="SECTION" /> 
		<result property="coverCd"		column="COVER_CD" /> 
		<result property="coverName"	column="COVER_NAME" /> 
		<result property="bulletNo"		column="BULLET_NO" /> 
		<result property="sumInsured"	column="SUM_INSURED" /> 
		<result property="premRt"		column="PREM_RT" /> 
		<result property="premAmt"		column="PREM_AMT" /> 
		<result property="addSi"		column="ADD_SI" /> 
		<result property="discountTag"	column="DISCOUNT_TAG" /> 
		<result property="origSi"		column="ORIG_SI" /> 
		<result property="origPremRt"	column="ORIG_PREM_RT" /> 
		<result property="origPrem"		column="ORIG_PREM" /> 
		<result property="createUser"	column="CREATE_USER" /> 
		<result property="createDate"	column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
		<result property="updateUser"	column="UPDATE_USER" /> 
		<result property="updateDate"	column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpCoverage" id="expCoverageMap">
		<result property="policyId"			column="POLICY_ID" />
		<result property="projId"			column="PROJ_ID" />
		<result property="riskId"			column="RISK_ID" />
		<result property="sectionISi"		column="SECTION_I_SI" />
		<result property="sectionIiSi"		column="SECTION_II_SI" />
		<result property="sectionIiiSi"		column="SECTION_III_SI" />
		<result property="totalSi"			column="TOTAL_SI" />
		<result property="sectionIPrem"		column="SECTION_I_PREM" />
		<result property="sectionIiPrem"	column="SECTION_II_PREM" />
		<result property="sectionIiiPrem"	column="SECTION_III_PREM" />
		<result property="totalPrem"		column="TOTAL_PREM" />
		<result property="currencyCd"		column="CURRENCY_CD" />
		<result property="currencyRt"		column="CURRENCY_RT" />
		<result property="pctShare"			column="PCT_SHARE" />
		<result property="pctPml"			column="PCT_PML" />
		<result property="totalValue"		column="TOTAL_VALUE" />
		<result property="remarks"			column="REMARKS" />
		<result property="origSeciSi"		column="ORIG_SECI_SI" />
		<result property="origSeciiSi"		column="ORIG_SECII_SI" />
		<result property="origSeciiiSi"		column="ORIG_SECIII_SI" />
		<result property="origTsi"			column="ORIG_TSI" />
		<result property="origSeciPrem"		column="ORIG_SECI_PREM" />
		<result property="origSeciiPrem"	column="ORIG_SECII_PREM" />
		<result property="origSeciiiPrem"	column="ORIG_SECIII_PREM" />
		<result property="origTprem"		column="ORIG_TPREM" />
		<result property="createUser"		column="CREATE_USER" />
		<result property="createDate"		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser"		column="UPDATE_USER" />
		<result property="updateDate"		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpCatPeril" id="expCatPerilMap">
		<result property="policyId"			column="POLICY_ID" />
		<result property="catPerilId"		column="CAT_PERIL_ID" />
		<result property="pctSharePrem"		column="PCT_SHARE_PREM" />
		<result property="createUser"		column="CREATE_USER" />
		<result property="createDate"		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser"		column="UPDATE_USER" />
		<result property="updateDate"		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.ExpEndorsement" id="expEndorsementMap">
		<result property="policyId"		column="POLICY_ID" /> 
		<result property="endtCd"		column="ENDT_CD" /> 
		<result property="changeTag"	column="CHANGE_TAG" /> 
		<result property="remarks"		column="REMARKS" /> 
		<result property="createUser"	column="CREATE_USER" /> 
		<result property="createDate"	column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
		<result property="updateUser"	column="UPDATE_USER" /> 
		<result property="updateDate"	column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" /> 
	</resultMap>
	
	<select id="retrieveExpPolList" resultMap="retrieveExpPolListMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.get_exp_policy(#{policyId, jdbcType=VARCHAR}, #{extractUser, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpProject" resultMap="expProjectMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.get_exp_project(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpItem" resultMap="expItemMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.GET_EXP_ITEM(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpDeductibles" resultMap="expDeductiblesMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.GET_EXP_DEDUCTIBLES(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpSectionCover" resultMap="expSectionCoverMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.GET_EXP_SECT_COV(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpCoverage" resultMap="expCoverageMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.GET_EXP_COVERAGE(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpCatPeril" resultMap="expCatPerilMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.GET_EXP_CAT_PERIL(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<select id="retrieveExpEndorsement" resultMap="expEndorsementMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_EXT_PKG.GET_EXP_ENDORSEMENTS(#{policyId, jdbcType=VARCHAR}))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.DistWrisk" id="retRiskDist">
		<result property="riskDistId" 		column="RISK_DIST_ID" />
		<result property="coinsGrpId" 		column="COINS_GRP_ID" />
		<result property="status" 			column="STATUS" />
		<result property="retLineAmt" 		column="RET_LINE_AMT" />
		<result property="retOneLines" 		column="RET1_LINES" />
		<result property="retTwoLines" 		column="RET2_LINES" />
		<result property="autoCalc" 		column="AUTO_CALC" />
		<result property="tsiAmt" 			column="TSI_AMT" />
		<result property="premAmt" 			column="PREM_AMT" />
		<result property="negateDate" 		column="NEGATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="negateUser" 		column="NEGATE_USER" />
		<result property="createUser" 		column="CREATE_USER" />
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser" 		column="UPDATE_USER" />
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="retOneTsiAmt" 	column="RET1_TSI_AMT" />
		<result property="retOnePremAmt" 	column="RET1_PREM_AMT" />
		<result property="retTwoTsiAmt" 	column="RET2_TSI_AMT" />
		<result property="retTwoPremAmt" 	column="RET2_PREM_AMT" />
		<result property="totalTsiAmt" 		column="TOTAL_TSI_AMT" />
		<result property="totalPremAmt" 	column="TOTAL_PREM_AMT" />
		<association property="distRiskWtreaty" 	resultMap="retRiskWtreaty"/>
	</resultMap>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.DistRiskWtreaty" id="retRiskWtreaty">
		<result property="treatyId"     column="TREATY_ID" />
		<result property="treatyName"   column="TREATY_NAME" />
		<result property="trtyCedId"    column="TRTY_CED_ID" />
		<result property="trtyCedName"  column="TRTY_CED_NAME" />
		<result property="pctShare"     column="PCT_SHARE" />
		<result property="siAmt"        column="SI_AMT" />
		<result property="premAmt"      column="T_PREM_AMT" />
		<result property="commShare"    column="COMM_SHARE" />
		<result property="createUser"   column="T_CREATE_USER" />
		<result property="createDate"   column="T_CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser"   column="T_UPDATE_USER" />
		<result property="updateDate"   column="T_UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<select id="retrieveDistWrisk" resultMap="retRiskDist" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_WRISK_PKG.ret_dist_wrisk(#{policyId},null,null,null,null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.WriskLimit" id="retWriskLimit">
		<result property="treatyLimitId" 	column="TREATY_LIMIT_ID" />
		<result property="treatyName" 		column="TREATY_NAME" />
		<result property="amount" 			column="AMOUNT" />
		<result property="trtyLayerDesc" 	column="TRTY_LAYER_DESC" />
		<result property="effDateFrom" 		column="EFF_DATE_FROM" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="effDateTo" 		column="EFF_DATE_TO" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="remarks" 			column="REMARKS" />
		<result property="createUser" 		column="CREATE_USER" />
		<result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser" 		column="UPDATE_USER" />
		<result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<select id="retrieveWriskLimit" resultMap="retWriskLimit" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_WRISK_PKG.wrisk_limit(#{lineCd}, #{lineClassCd},null,null,null,null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.PoolDistribution" id="retPoolDistMap">
		<result property="riskDistId"		column="RISK_DIST_ID" />
		<result property="treatyId"			column="TREATY_ID" />
		<result property="treatyAbbr"		column="TREATY_ABBR" />
		<result property="trtyCedId"		column="TRTY_CED_ID" />
		<result property="cedingId"			column="CEDING_ID" />
		<result property="cedingName"	    column="CEDING_NAME" />
		<result property="retOneLines"		column="RET1_LINES" />
		<result property="retOneTsiAmt"		column="RET1_TSI_AMT" />
		<result property="retOnePremAmt"	column="RET1_PREM_AMT" />
		<result property="retTwoLines"		column="RET2_LINES" />
		<result property="retTwoTsiAmt"		column="RET2_TSI_AMT" />
		<result property="retTwoPremAmt"	column="RET2_PREM_AMT" />
		<result property="createUser"		column="CREATE_USER" />
		<result property="createDate"		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		<result property="updateUser"		column="UPDATE_USER" />
		<result property="updateDate"		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<select id="retrievePoolDist" resultMap="retPoolDistMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_RISK_WCEDING_PKG.ret_risk_wceding(#{riskDistId},null,null,null,null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.DistCoIns" id="retDistCoInsMap">
		 <result property="riskDistId" 		column="RISK_DIST_ID" />
		 <result property="distId" 			column="DIST_ID" />
		 <result property="policyNo" 		column="POLICY_NO" />
		 <result property="cedingId" 		column="CEDING_ID" />
		 <result property="cedingName" 		column="CEDING_NAME" />
		 <result property="pctShare" 		column="PCT_SHARE" />
		 <result property="siAmt" 			column="SI_AMT" />
		 <result property="premAmt" 		column="PREM_AMT" />
		 <result property="createUser" 		column="CREATE_USER" />
		 <result property="createDate" 		column="CREATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
		 <result property="updateUser" 		column="UPDATE_USER" />
		 <result property="updateDate" 		column="UPDATE_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler" />
	</resultMap>
	
	<select id="retrieveDistCoIns" resultMap="retDistCoInsMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(DIST_RISK_WCO_INS_PKG.ret_risk_wco_ins(#{riskDistId},null,null,null,null))
	</select>
	
	<resultMap type="ph.cpi.rest.api.model.underwriting.PolForPurging" id="purgingMap">
		 <result property="policyId" 		column="POLICY_ID" />
		 <result property="policyNo" 		column="POLICY_NO" />
		 <result property="totalSi" 		column="TSI_AMOUNT" />
		 <result property="totalPrem" 		column="TOTAL_PREM" />
		 <result property="expiryDate" 		column="EXPIRY_DATE" typeHandler="ph.cpi.rest.api.typehandler.DateTimeTypeHandler"/>
		 <result property="processTag" 		column="PROCESS_TAG" />
		 <result property="expiryTag" 		column="EXPIRY_TAG" />
		 </resultMap>
	
	<select id="retrievePolForPurging" resultMap="purgingMap" parameterType="java.util.Map">
		SELECT * FROM TABLE(PURGE_EXP_PKG.ret_purge_Exp(#{policyId, jdbcType=VARCHAR},null,null,null,null))
	</select>
	
	<update id="purgeExpiringPol" parameterType="java.util.Map">
		BEGIN
			<foreach collection="deletePurge" item="del">
					PURGE_EXP_PKG.purge_ext_policy(#{del.policyId});
			</foreach>
		END;
	</update>
</mapper>